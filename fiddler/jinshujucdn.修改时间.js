(self.webpackChunk_gd_fe_system=self.webpackChunk_gd_fe_system||[]).push([[6310],{75342:function(e,t,n){"use strict";n.d(t,{R:function(){return l},S:function(){return s}});var i=n(30326),o=n(17538),r=n(66710),a=n(43192),s=function(e){return"blue"},l=function(){return Object.entries(a.Z).reduce((function(e,t){var n=(0,r.Z)(t,2),a=n[0],s=n[1],l=a.split("."),d=(0,r.Z)(l,2),u=d[0],c=d[1];return(0,o.Z)((0,o.Z)({},e),{},(0,i.Z)({},u,(0,o.Z)((0,o.Z)({},e[u]),{},(0,i.Z)({},c,s))))}),{})}},78602:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var i=n(11345),o=n(35281),r=n(30931),a=n.n(r),s=n(75342),l=n(44581),d=function(e){var t=e.children,n=e.withoutPonyfill,r=e.theme,d=void 0===r?"orange":r,u=e.className,c=void 0===u?"":u,m=(0,i.useMemo)((function(){return n?{}:(0,s.R)()}),[n]);return(0,i.useEffect)((function(){d&&(document.documentElement.setAttribute("data-theme",d),!("undefined"!==typeof window&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"))&&(0,o.Z)({onlyLegacy:!0,variables:m[d]}))}),[d,m]),(0,l.jsx)("div",{className:a()("theme-provider-wrapper",c),children:t})}},36854:function(e,t,n){"use strict";n.d(t,{t:function(){return m},X:function(){return c}});var i=n(33270),o=n(93961),r=n(56845),a=n(22906),s=n(95514),l=n(97860),d=n(10273),u=n(77757),c=function(){function e(t){var n=this;(0,i.Z)(this,e),this.field=void 0,this.normalize=function(e,t){if(!e&&"number"!==typeof e)return e;var i=n.field.thousandsSeparator?e.toString().replace(/\$\s?|(,*)/g,""):e.toString();return n.field.thousandsSeparator?(0,u.YQ)(i)?parseFloat(parseFloat(i).toFixed(n.field.precision||0)):t:e},this.onBlur=function(e,t){var i=n.field,o=i.displayAsPercentage,r=i.thousandsSeparator;if(t||0===t){var a=r?t.toString().replace(/\$\s?|(,*)/g,""):t.toString();!o&&!r||(0,u.YQ)(a)||e.preventDefault()}else e.preventDefault()},this.field=t}return(0,o.Z)(e,[{key:"getFieldProps",value:function(){return{onBlur:this.onBlur,normalize:this.normalize}}}]),e}(),m=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(e){var o;return(0,i.Z)(this,n),(o=t.call(this,e)).field=void 0,o.precisionValue=void 0,o.format=function(e){return e&&o.field.displayAsPercentage&&(0,u.YQ)(e.toString())?parseFloat((0,s.Z)((0,l.Z)(e,100),o.precisionValue).toFixed(o.precisionValue||12)):e},o.normalize=function(e,t){return(e||"number"===typeof e)&&o.field.displayAsPercentage?(0,u.YQ)(e.toString())?parseFloat((0,d.Z)(e,100).toFixed(o.field.precision||12)):t:e},o.field=e,o.precisionValue=o.field.precision&&o.field.precision>2?o.field.precision-2:0,o}return(0,o.Z)(n,[{key:"getFieldProps",value:function(){return{format:this.format,normalize:this.normalize,onBlur:this.onBlur}}}]),n}(c)},50975:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var i=n(17538),o=n(11345),r=n(44581),a=n(77757),s=n(60930),l=function(e){var t,n=e.className,l=e.bannerStyle,d=e.header,u=(0,o.useContext)(s.V5).form,c=null===u||void 0===u?void 0:u.storageConfig,m=d.backgroundColor,f=Object.assign(l||{},(0,i.Z)({},{backgroundColor:m})||{});return(0,r.jsx)("div",{className:n,style:f,children:d.image&&(0,r.jsx)("img",{src:d.image?(null===(t=d.image)||void 0===t?void 0:t.visitUrl)+"".concat("qiniu"===(null===c||void 0===c?void 0:c.provider)?"@hixlarge"+(a.w0?"Retina":""):""):"",alt:document.title})})},d=n(79803),u=n(13950),c=function(e){return(0,r.jsx)("a",{className:"carousel__button-prev",onClick:e.onClick,children:(0,r.jsx)(d.Z,{type:"angle-left"})})},m=function(e){return(0,r.jsx)("a",{className:"carousel__button-next",onClick:e.onClick,children:(0,r.jsx)(d.Z,{type:"angle-right"})})},f=function(e){var t=e.images,n=e.previewPagination,o=void 0!==n&&n,a=e.autoplay,s=void 0===a||a,l=e.dotsClass,d=void 0===l?"slick-dots slick-thumb custom-slick-dots":l,f=e.customPaging,p={customPaging:void 0===f?function(e){return(0,r.jsx)("a",{children:(0,r.jsx)("img",{src:t?"".concat(t[e],"?imageView2/1/w/70/h/26"):"",alt:"carouselImages"})})}:f,dotsClass:d,autoplay:s,dots:!0,infinite:!0,speed:500,slidesToShow:1,slidesToScroll:1,prevArrow:(0,r.jsx)(c,{}),nextArrow:(0,r.jsx)(m,{})};return o||(delete p.customPaging,delete p.dotsClass),(0,r.jsx)(u.Z,(0,i.Z)((0,i.Z)({},p),{},{className:"carousel__container",children:t.map((function(e,t){return(0,r.jsx)("img",{src:"".concat(e,"?imageView2/1/w/1600/h/600"),alt:"image"},t)}))}))},p={text:function(e){var t=e.className,n=e.bannerStyle,o=e.header,a=o.backgroundColor,s=Object.assign(n||{},(0,i.Z)({},{backgroundColor:a})||{});return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:t,style:s,children:(0,r.jsx)("div",{className:"text",children:o.text})})})},image:l,carousel:function(e){var t=e.className,n=e.bannerStyle,o=e.header,a=e.autoplay,s=o.backgroundColor,l=o.carouselImages,d=o.carouselType,u=Object.assign(n||{},(0,i.Z)({},{backgroundColor:s})||{});return(0,r.jsx)("div",{className:t,style:u,children:l&&(0,r.jsx)(f,{images:l.map((function(e){return e.visitUrl})),previewPagination:"thumbnail"===d,autoplay:a})})}}},27971:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var i=n(17538),o=n(33270),r=n(93961),a=n(56845),s=n(22906),l=n(30931),d=n.n(l),u=n(54103),c=n(11345),m=n(361),f=n(44581),p=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,o.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.description,o=e.theme,r=e.formDesigner,a=e.visible,s=void 0===a||a,l=e.previewMode,c=void 0!==l&&l,p=o.typography,v=p.formHeader,h=p.showPartDescription,_=(0,m.P)(v);return(0,f.jsxs)("div",{className:d()("form-header__container",{hide:!s}),children:[(0,f.jsx)("div",{className:"form-header__title",style:(0,i.Z)({},_),children:t}),(0,f.jsx)(u.Z,{description:n,showPartDescription:h,formDesigner:r,previewMode:c})]})}}]),n}(c.Component),v=p},85790:function(e,t,n){"use strict";n.d(t,{Z:function(){return Ei}});var i=n(66710),o=n(93545),r=n(81852),a=(n(76305),n(23740)),s=n.n(a),l=n(45849),d=n(17538),u=n(30326),c=n(37299),m=n(33270),f=n(93961),p=n(2537),v=n(56845),h=n(22906),_=n(76002),g=n(47429),b=n(46389),P=n.n(b),y=n(57595),C=n(38632),T=n(74288),E=n(36870),A=n(16387),S=n(55537),F=n(17572),Z=n(95678),x=n(67806),R=n(95880),k=n(12918),O=n(47677),w=n(46731),j=n(3802),N=n(81015),I=n(1677),D=n(77706),M=n(70017),L=n(53488),B=n(33237),V=n(36620),H=n(77743),U=n(16546),G=n(89112),W=n(56194),K=n(42819),q=n(18758),Y=n(52523),X=n(87679),$=n(16593),J=n(11345),z=n(87012),Q=n(38429),ee=n(793),te=n(33265),ne=n(2911),ie=n(59631),oe=n(4716),re=n(75342),ae=n(19410),se=n(32698),le=n(27208),de=n(29408),ue=function(){function e(t){(0,m.Z)(this,e),this.field=void 0,this.field=t}return(0,f.Z)(e,[{key:"validate",value:function(e){var t=this.field,n=t.apiCode,i=t.validations;if("object"===typeof e&&i&&i.some((function(e){return"other_choice_presence"===e}))){var o=e[n],r=e[n+"_other"];if(null==o)return null;var a=this.field.choices;return a&&a.find((function(e){var t="OtherChoice"===e.__typename,n="string"===typeof o&&e.value===o,i="object"===typeof o&&o.includes(e.value);return t&&(n||i)}))&&(0,y.Z)(r)?this.errorMessage():null}return null}},{key:"errorMessage",value:function(){return de.Z.t("common.error.otherPresence",{ns:"field"})}}]),e}(),ce=n(4520),me=n(20907),fe=n(60930),pe=n(63706),ve=n(64819);var he=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{pollingInterval:50,maxTimeout:6e4},n=0,i=t.maxTimeout/t.pollingInterval;return new Promise((function(t,o){var r;r=window.setInterval((function(){n++,document.querySelector(e)&&(t(),clearInterval(r)),n>=i&&(o(),clearInterval(r))}),50)}))},_e=n(91016),ge=n(42474),be=n(98936),Pe=n(7414),ye=function(e,t,n){window.stm_clicki&&window.stm_clicki("send","event",e,t,n,1)},Ce=n(77757),Te=n(87221),Ee=n(361),Ae=n(73097),Se=n(54093),Fe=n(98301),Ze=n(30796),xe=n.n(Ze),Re=n(97047),ke=n.n(Re),Oe=n(53732),we=n(84471),je=n(67721),Ne=n(30417),Ie=n(85951),De=n(71963),Me=n(45058),Le=n(95452),Be=n(56251),Ve=n(71069),He=n(48955),Ue=n(6850),Ge=n.n(Ue),We=T.Z,Ke=function(){function e(t){var n=this;(0,m.Z)(this,e),this.publishedLayoutInstance=t,this.errorFields=[],this.forceSubmit=function(){try{(0,be.Z)()}catch(e){console.info(e)}return n._forceSubmit().finally((function(){var e,t;"undefined"!==typeof GD&&(null===(e=GD)||void 0===e||null===(t=e.hideClosedWarningModal)||void 0===t||t.call(e))}))},this._forceSubmit=(0,He.Z)(Ge().mark((function e(){var t,i,o;return Ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.formValues,!(0,ve.GE)(n.scene)){e.next=9;break}return e.next=4,n.validateUnScorableFieldsValues();case 4:return i=n.getValidateFailFields(),o=n.errorFields.map((function(e){return(0,T.Z)(e,"path[1]")})),0===(0,r.Z)(new Set([].concat((0,r.Z)(i),[o]))).length&&i.forEach((function(e){n.formFields.find((function(t){return t.apiCode===e})).scorable&&delete t[e]})),e.abrupt("return",n.publishedLayoutInstance.submit(t,!0));case 9:case"end":return e.stop()}}),e)}))),this.validateUnScorableFieldsValues=function(){var e,t,i,o=n.state.xFieldWeixinOpenid,r={formId:n.token,entryAttributes:n.getFormUnscorableFieldsValues(),xFieldWeixinOpenid:o,password:n.password,routeType:n.routeType};return null===(e=n.props)||void 0===e||null===(t=e.validatePublishedFormFields)||void 0===t||null===(i=t.call(e,r))||void 0===i?void 0:i.then((function(e){var t=e.data.validatePublishedFormFields.errors||[];return t.forEach((function(e){var t,n;null!==(t=e.path)&&void 0!==t&&t[1]&&(e.path[1]=null===(n=e.path[1].match(/^field_\d+/))||void 0===n?void 0:n[0])})),n.setState({validateErrorFields:t}),n.errorFields=t,e}))}}return(0,f.Z)(e,[{key:"props",get:function(){return this.publishedLayoutInstance.props}},{key:"state",get:function(){return this.publishedLayoutInstance.state}},{key:"setState",get:function(){return this.publishedLayoutInstance.setState.bind(this.publishedLayoutInstance)}},{key:"token",get:function(){return this.publishedLayoutInstance.token}},{key:"scene",get:function(){var e;return null===(e=this.props.publishedFormData.publishedForm.form)||void 0===e?void 0:e.scene}},{key:"routeType",get:function(){return this.props.routeType}},{key:"publishedForm",get:function(){return this.props.publishedFormData.publishedForm}},{key:"formFields",get:function(){var e;return(null===(e=this.publishedForm.form)||void 0===e?void 0:e.fields.nodes)||[]}},{key:"unScorableFiels",get:function(){return this.formFields.filter((function(e){return!e.scorable}))}},{key:"publishReduxForm",get:function(){return We(this,"publishedLayoutInstance.publishedFormRef.current.ref.current")}},{key:"scorableFiels",get:function(){return this.formFields.filter((function(e){return e.scorable}))}},{key:"password",get:function(){return(0,$.parse)(document.cookie.split("; ").join("&"))["access_password_".concat(this.token)]}},{key:"formValues",get:function(){return(0,d.Z)((0,d.Z)({},this.getLocalFormValues()),this.props.formValue)}},{key:"getLocalFormValues",value:function(){var e;return JSON.parse((null===(e=localStorage)||void 0===e?void 0:e.getItem("publishedForm-".concat(this.token)))||"{}")}},{key:"getFormUnscorableFieldsValues",value:function(){var e=this.formValues;return this.unScorableFiels.reduce((function(t,n){return t[n.apiCode]=e[n.apiCode]||null,t}),{})}},{key:"getValidateFormFieldsResult",value:function(){var e={};if(this.publishReduxForm){var t=this.formValues;Object.entries(this.publishReduxForm.fieldValidators).forEach((function(n){var o=(0,i.Z)(n,2),r=o[0],a=o[1],s=t[r],l=!a()||a().every((function(e){return void 0===e(s)}));e[r]=l}))}return e}},{key:"getValidateFailFields",value:function(){return Object.entries(this.getValidateFormFieldsResult()).reduce((function(e,t){var n=(0,i.Z)(t,2),o=n[0];return n[1]?e:[].concat((0,r.Z)(e),[o])}),[])}}]),e}(),qe=(n(81654),n(37257)),Ye=n(30931),Xe=n.n(Ye),$e=n(26663),Je=n(79803),ze=n(60921),Qe="ReservationHistoryButton_btn__+czya",et="ReservationHistoryButton_angle-icon__qLkk8",tt=n(44581),nt=function(e){var t=e.formToken,n=e.entranceOpenEntry,i=e.buttonThemeColor,o=n.token,r=n.entranceText,a=(0,J.useRef)(null);return(0,J.useEffect)((function(){var e,t;i&&(null===(e=a.current)||void 0===e||e.style.setProperty("--button-color",i),null===(t=a.current)||void 0===t||t.style.setProperty("--button-hover-bg-color",(0,ze.CD)(.1,i,"#fff")))}),[i]),(0,tt.jsxs)("a",{ref:a,className:Qe,href:"/f/".concat(t,"/oe/").concat(o),target:"_blank",rel:"noopener noreferrer",children:[r,(0,tt.jsx)(Je.Z,{type:"angle-right",className:et})]})},it=function(e){var t,n=e.form,i=e.theme,o=null===(t=n.setting)||void 0===t?void 0:t.entranceOpenEntry;return(0,tt.jsx)(tt.Fragment,{children:!!o&&(0,tt.jsx)(nt,{entranceOpenEntry:o,formToken:n.token,buttonThemeColor:i.submitButton.style.backgroundColor})})},ot=n(78602),rt=n(11588),at=n(92495),st=n(72931),lt=n(25541),dt=n(91529),ut=n(29313),ct=["field","input","meta","valueRelated","formValueSubject$","htmlEntity","scene","isCaScene"],mt=function(e){var t=e.field,n=e.input,i=e.meta,r=e.valueRelated,a=e.formValueSubject$,s=e.htmlEntity,l=(e.scene,e.isCaScene),u=(0,o.Z)(e,ct),c=t.type,m=t.apiCode,f=(0,J.useMemo)((function(){return Oe.Z.getDefinitionOf(c).component}),[c]);f.displayName=c;var p=Oe.Z.getPrefixOf(c).prefix,v={};return["BasicGoodsField","GoodsField","TableField"].some((function(e){return c===e}))&&n&&!n.value&&(v={value:i.initial}),(0,tt.jsx)(f,(0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)({},t),n),v),{},{meta:i,onRelatedChange:function(e){var t=(0,T.Z)(i,"dispatch"),n=(0,T.Z)(i,"form");t&&t((0,ut.gj)({meta:{form:n,field:m},payload:e}))},valueRelated:r,formValueSubject$:a,htmlEntity:s,prefix:p,className:"field ".concat(m),isPublished:!0},u),{},{isCaScene:l}))};mt.displayName="FieldRenderer";var ft=mt=J.memo(mt),pt=st.Z,vt=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).validators=(0,dt.Z)(e.props.field),e.fieldProps=(0,lt.Z)(e.props.field),e.specificValidators=Oe.Z.getDefinitionOf(e.props.field.type).specificValidators.map((function(t){return function(n){return new t(e.props.field).validate(n)}})),e}return(0,f.Z)(n,[{key:"render",value:function(){var e=this.props,t=e.field,n=e.formValueSubject$,i=e.xFieldWeixinOpenid,o=e.fieldDefinition,a=e.scene,s=e.previewMode,l=e.previewMobile,u=e.typography,c=e.token,m=e.routeType,f=e.setting,p=e.isCaScene,v=e.storageConfig,h=e.themeSubmitButton;return(0,tt.jsx)(pt,(0,d.Z)((0,d.Z)({name:t.apiCode,valueRelated:this.props.valueRelated,formValueSubject$:n,field:t,xFieldWeixinOpenid:i,htmlEntity:this.props.htmlEntity,validate:[].concat((0,r.Z)(this.validators),(0,r.Z)(this.specificValidators)),scene:a,fieldDefinition:o,component:ft,previewMode:s,previewMobile:l,typography:u,token:c,routeType:m,setting:f,storageConfig:v,format:null},this.fieldProps),{},{isCaScene:p,themeSubmitButton:h}))}}]),n}(J.PureComponent),ht=(0,Q.Zh)(["field"])(vt),_t=n(290),gt=n(12183),bt=n(41543);function Pt(e,t,n){var i=e.getBoundingClientRect(),o=t||document,r=n||window;return i.top<=((null===r||void 0===r?void 0:r.innerHeight)||(null===o||void 0===o?void 0:o.documentElement.clientHeight))&&i.left<=((null===r||void 0===r?void 0:r.innerWidth)||(null===o||void 0===o?void 0:o.documentElement.clientWidth))}var yt=n(7067),Ct=(n(30409),n(18007)),Tt=n(80757),Et=n(71744),At=n(65712),St=n(96658),Ft=(0,ee.$j)((function(e,t){var n,i="publishedForm.".concat(null===(n=t.form)||void 0===n?void 0:n.token);return{formValues:(0,At.Z)(i)(e)}}))((function(e){var t=e.isSubmitting,n=e.formStatus,i=e.form,o=e.theme,r=e.onSubmit,a=e.fields,s=e.formValues,l=e.previewMode,u=o.shadow,c=i.setting.paymentChannels&&i.setting.paymentChannels.length>0,m=s&&a&&a.some((function(e){return Fe.wBw.includes(e.__typename)})),f=i.setting.enableCaptcha&&!l,p=!1;if(m){var v=s&&a&&a.every((function(e){return!Fe.wBw.includes(e.__typename)||s[e.apiCode].every((function(e){return 0===e.number}))&&e.validations.includes(St.Zg.Presence)}));p=c&&v}return(0,tt.jsx)(fe.T8.Consumer,{children:function(e){var a=e.disabledSubmitButton,s=(e.publishedFormInstance,e.dynamicAttrsLoading),l=e.updateGeetestCaptchaInfo,c="open"!==n||t||a||p||s;return(0,tt.jsx)(Et.Z,{enableCaptcha:f,lang:(0,Et.H)(i.setting.locale),type:"other",onSuccess:function(e){var t=e.captchaObj.getValidate(),n=t.geetest_challenge,i=t.geetest_seccode,o=t.geetest_validate;l({challenge:n,seccode:i,validate:o}),r()},children:function(e){var t=e.enableGeeTest,n=e.captchaLoading,a=e.captchaObj;return(0,tt.jsx)(Tt.Z,{type:"primary",disabled:c,className:"published-form__submit form-theme--submit-button",loading:f&&n,onClick:function(){var e=function(){f&&t?a.verify():r()};f?n||!n&&t?e():document.getElementsByClassName("published-form__sentinel")[1].scrollIntoView():e()},style:(0,d.Z)((0,d.Z)((0,d.Z)({},(0,C.Z)(o.style,["padding"])),{boxShadow:u&&"0 0 1px rgba(0, 0, 0, 0.2)",padding:"0",width:"100%"}),{backgroundColor:c?(0,ze.m4)(o.style.backgroundColor||"#f4f4f4",.2):o.style.backgroundColor}),children:i.setting.wording})}})}})})),Zt=n(58945),xt=n(78257),Rt=n(54424),kt=n(35882),Ot=n.n(kt),wt=null,jt=J.memo((function(e){var t=e.token,n=e.t,o=e.count,r=void 0===o?0:o,a=(0,J.useState)(!1),s=(0,i.Z)(a,2),l=s[0],d=s[1],u=(0,J.useState)(!1),m=(0,i.Z)(u,2),f=m[0],p=m[1],v=(0,J.useState)(r),h=(0,i.Z)(v,2),_=h[0],g=h[1],b=(0,Rt.D)(Ot()),P=(0,i.Z)(b,1)[0],C="form_".concat(t,"_already_liked"),T=function(e){var i=!(0,Te.ij)(C);e===i&&P({variables:{formId:t,increase:e}}).then((function(n){var i,o,r,a=n.data;if((0,y.Z)(a.likeForm.errors)){var s="/f/".concat(t);e?(0,Te.cW)({name:C,value:"true",days:7,path:s}):(0,Te.Od)(C,s),g(null!==(i=null===a||void 0===a||null===(o=a.likeForm)||void 0===o||null===(r=o.form)||void 0===r?void 0:r.likeCount)&&void 0!==i?i:_),d(e)}else{var l,u;null===a||void 0===a||null===(l=a.likeForm)||void 0===l||null===(u=l.errors)||void 0===u||u.forEach((function(t){c.Z.error(t.message),d(!e),g(_)}))}})).catch((function(){c.Z.error(n("like_failed")),d(!e),g(_)}))};(0,J.useEffect)((function(){d(!!(0,Te.ij)(C)),wt=(0,xt.Z)(T,300)}),[]),(0,J.useEffect)((function(){g(r)}),[r]);return(0,tt.jsxs)("div",{className:Xe()("published-form__like-link",{animated:f,liked:!f&&l}),onClick:function(){if(_||!l){var e=!l;d(e),p(e),g(e?_+1:_-1),wt&&wt(e)}},children:[(0,tt.jsx)("div",{className:"thumb-up",children:(0,tt.jsx)(Je.Z,{type:"thumbs-up"})}),(0,tt.jsx)("div",{className:"bling bling-1"}),(0,tt.jsx)("div",{className:"bling bling-2"}),(0,tt.jsx)("div",{className:"bling bling-3"}),(0,tt.jsx)("div",{className:"bling bling-4"}),(0,tt.jsxs)("span",{className:"likes",children:[(0,tt.jsx)("span",{children:n("awesome")}),_?(0,tt.jsx)("span",{children:_<1e4?_:n("like_unit",{number:(_/1e4).toFixed(1)})}):null]})]})})),Nt=n(63879),It=n(3915),Dt=n(99863),Mt=n(60711),Lt=(n(2780),n(41121)),Bt="PaginateButton_button__0G+B4",Vt=["style","submitButtonStyle","className"],Ht=["fontFamilyRaw","padding","backgroundColor"],Ut=function(e){var t=e.style,n=e.submitButtonStyle,r=e.className,a=(0,o.Z)(e,Vt),s=n||{},l=(s.fontFamilyRaw,s.padding,s.backgroundColor),c=(0,o.Z)(s,Ht),m=a.disabled?(0,ze.m4)(l||"#f4f4f4",.2):l||"",f=Object.entries(c).reduce((function(e,t){var n=(0,i.Z)(t,2),o=n[0],r=n[1],a=r?(0,u.Z)({},o,r):{};return(0,d.Z)((0,d.Z)({},e),a)}),{});return(0,tt.jsx)(Lt.default,(0,d.Z)((0,d.Z)({},a),{},{style:(0,d.Z)((0,d.Z)((0,d.Z)({},t),f),{},{backgroundColor:m}),className:Xe()(r,[Bt])}))},Gt=n(61671),Wt=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).isMobileScreen=!1,e.footerRef=J.createRef(),e.top=J.createRef(),e.bottom=J.createRef(),e.lastScrollTop=0,e.event=null,e.fieldsChanged=null,e.topObserver=null,e.footerObserver=null,e.state={captchaInfo:null,captchaDataAttribute:null,footerIsInViewport:!1},e.scrollToBottom=function(){e.footerRef.current.classList.contains("in-sticky")&&e.bottom.current.scrollIntoView()},e.mobileSubmit=function(){e.scrollToBottom(),e.props.onSubmit()},e.mobileSubmitWithoutPrivacyValidate=function(){e.scrollToBottom(),e.props.onSubmitWithoutPrivacyValidate()},e.setStickyObserver=function(){e.topObserver=new IntersectionObserver((function(t){t[0].isIntersecting?e.footerRef.current.classList.remove("in-sticky"):e.footerRef.current.classList.add("in-sticky")})),e.topObserver.observe(e.top.current)},e.setFooterObserver=function(){e.footerObserver=new IntersectionObserver((function(t){t[0].isIntersecting&&(e.setState({footerIsInViewport:!0}),e.footerObserver&&e.footerObserver.unobserve(e.footerRef.current),e.footerObserver=null)})),e.footerObserver.observe(e.footerRef.current)},e.dispatchPagination=function(t){var n=t.current,i=t.total;e.event&&(e.event.initCustomEvent("pagination",!0,!0,{current:n,total:i}),window.dispatchEvent(e.event))},e.validateReservation=function(e,t,n){return Gt.xs.Reservation!==e.scene||!t.filter((function(e){return Gt.SZ.ReservationField===e.__typename})).some((function(e){var t;return(null===(t=n[e.apiCode])||void 0===t?void 0:t.length)>0}))},e.unobserverFooter=function(){e.footerObserver&&(e.footerObserver.unobserve(e.footerRef.current),e.footerObserver=null)},e}return(0,f.Z)(n,[{key:"componentDidUpdate",value:function(e,t,n){var i=this.props,o=i.currentPage,r=i.totalPages,a=i.fields,s=i.currentPageBreak,l=e.currentPage,d=e.totalPages,u=e.fields,c=e.currentPageBreak;null==(null===c||void 0===c?void 0:c.countDown)&&null!=(null===s||void 0===s?void 0:s.countDown)&&(this.unobserverFooter(),this.setState({footerIsInViewport:!1}),this.setFooterObserver()),o===l&&r===d||this.dispatchPagination({current:o,total:r}),a.length===u.length&&(0,Zt.Z)(a,u,(function(e,t){if(!Array.isArray(e)&&!Array.isArray(t))return e.apiCode===t.apiCode}))||(this.fieldsChanged&&this.fieldsChanged.initCustomEvent("field_rules_changed",!0,!0,{}),this.fieldsChanged&&window.dispatchEvent(this.fieldsChanged))}},{key:"componentDidMount",value:function(){var e=this.props,t=e.currentPage,n=e.totalPages,i=e.currentPageBreak;this.event=document.createEvent("CustomEvent"),this.fieldsChanged=document.createEvent("CustomEvent"),this.dispatchPagination({current:t,total:n}),this.isMobileScreen&&(this.lastScrollTop=window.pageYOffset||document.documentElement.scrollTop,this.setStickyObserver()),null!=(null===i||void 0===i?void 0:i.countDown)?this.setFooterObserver():this.setState({footerIsInViewport:!0})}},{key:"componentWillUnmount",value:function(){this.event=null,this.fieldsChanged=null,this.isMobileScreen&&(this.topObserver.unobserve(this.top.current),this.topObserver=null),this.footerObserver&&(this.footerObserver.unobserve(this.footerRef.current),this.footerObserver=null),this.unobserverFooter()}},{key:"render",value:function(){var e=this,t=this.props,n=t.isSubmitting,i=t.formStatus,o=t.form,r=t.theme,a=t.t,s=t.onSubmit,l=t.totalPages,u=t.currentPage,c=t.token,m=t.setCurrentPage,f=t.currentPageBreak,p=t.fields,v=t.formValues,h=t.previewMobile,_=t.previewMode,g=t.likeCount,b=t.isCaScene,P=t.requiredFieldsOnly,y=t.onSubmitWithoutPrivacyValidate;this.isMobileScreen=h||Ce.ZZ.isMobileScreen;var C=this.isMobileScreen?5:6,T=r.alignment,E=r.shadow,A=!P&&1!==u,S=!P&&u!==l,F=r.fixedToBottomInMobile&&this.isMobileScreen&&this.validateReservation(o,p,v),Z=f&&!f.disablePreviousPage?(0,tt.jsx)(Kt,{submitButtonStyle:o.theme.submitButton.style,currentPageBreak:f,setCurrentPage:m,currentPage:u}):null,x=!P&&l>1?(0,tt.jsx)("div",{className:"published-form__footer-pagination",children:a("pagination",{currentPage:u,totalPages:l})}):null,R=o.setting.paymentChannels&&o.setting.paymentChannels.length>0,k=v&&p&&p.some((function(e){return Fe.wBw.includes(e.__typename)})),O=o.setting.enableCaptcha&&!_,w=!1;if(k){var j=v&&p&&p.every((function(e){return!Fe.wBw.includes(e.__typename)||v[e.apiCode].every((function(e){return 0===e.number}))&&e.validations.includes(St.Zg.Presence)}));w=R&&j}var N=function(){e.isMobileScreen?e.mobileSubmit():s()};return(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)("div",{className:"published-form__sentinel",ref:this.top}),(0,tt.jsxs)("div",{className:Xe()("published-form__footer",T,{sticky:F,cascene:b(),"footer-hidden":null===Z&&null===x&&!0===r.hidden}),style:{textAlign:T},ref:this.footerRef,children:[A&&S&&Z,S?this.state.footerIsInViewport&&(0,tt.jsx)(qt,{submitButtonStyle:o.theme.submitButton.style,currentPageBreak:f,onSubmit:this.isMobileScreen?this.mobileSubmitWithoutPrivacyValidate:y}):(0,tt.jsx)(fe.T8.Consumer,{children:function(t){var s=t.hasSubmissionError,l=t.updateCaptchaInfo,u=t.updateGeetestCaptchaInfo,c=t.disabledSubmitButton,m=t.dynamicAttrsLoading;return(0,tt.jsx)(Et.Z,{enableCaptcha:O,lang:(0,Et.H)(o.setting.locale),type:"other",onSuccess:function(e){var t=e.captchaObj.getValidate(),n=t.geetest_challenge,i=t.geetest_seccode,o=t.geetest_validate;u({challenge:n,seccode:i,validate:o}),N()},children:function(t){var u=t.enableGeeTest,f=t.captchaLoading,p=t.captchaObj,v="open"!==i||n||c||w||m||(0,Mt.J)(),h=O&&f||!O&&n,g=(0,tt.jsxs)("div",{className:"published-form__footer-buttons",children:[Z,!r.hidden&&(0,tt.jsx)(Tt.Z,{type:"primary",disabled:v,className:"published-form__submit form-theme--submit-button",loading:h,onClick:function(){_||(O&&u?p.verify():N())},style:(0,d.Z)((0,d.Z)((0,d.Z)((0,d.Z)({},r.style),{boxShadow:E&&"0 0 1px rgba(0, 0, 0, 0.2)"}),{backgroundColor:v?(0,ze.m4)(r.style.backgroundColor||"#f4f4f4",.2):r.style.backgroundColor}),b()?{width:"100%"}:{}),children:h?a("common:submitting"):o.setting.wording}),x]});return O?f||!f&&u?g:(0,tt.jsx)(It.Z,{updateCaptchaInfo:l,hasSubmissionError:s,enableCaptcha:o.setting.enableCaptcha,size:C,scrollToBottom:e.scrollToBottom,displayWithCaptcha:(0,tt.jsxs)("div",{className:"published-form__footer-buttons",children:[Z,x]}),children:function(e){return e.showChildren&&g}}):g}})}}),S&&x,!_&&o.showAwesome&&(0,tt.jsx)(jt,{token:c,t:a,count:g}),o.setting.showReportLink&&(0,tt.jsx)(Nt.Z,{url:o.setting.reportLinkUrl,text:a("report"),className:"published-form__report-link"})]}),(0,tt.jsx)("div",{className:"published-form__sentinel",ref:this.bottom})]})}}]),n}(J.Component),Kt=function(e){var t=e.submitButtonStyle,n=e.currentPageBreak,i=e.currentPage,o=e.setCurrentPage;return(0,tt.jsx)(fe.T8.Consumer,{children:function(e){var r=e.disabledAllButton;return(0,tt.jsx)(Ut,{type:"primary",disabled:r,className:"form-theme--submit-button",onClick:function(){return null===o||void 0===o?void 0:o(i-1)},submitButtonStyle:t,children:null===n||void 0===n?void 0:n.previousPageText})}})},qt=function(e){var t=e.submitButtonStyle,n=e.currentPageBreak,i=e.onSubmit,o=n?n.countDown:0,r="countDown_".concat(o);return(0,tt.jsx)(Dt.Z,{intervalSecond:1,duration:o,autoTrigger:!0,detectChanges:n&&n.apiCode,children:function(e,o){return(0,tt.jsx)(fe.T8.Consumer,{children:function(r){var a=r.disabledAllButton;return(0,tt.jsx)(Ut,{type:"primary",className:"form-theme--submit-button",onClick:i,disabled:e||a,submitButtonStyle:t,children:n&&"".concat(n.nextPageText).concat(e?"(".concat(o,")"):"")})}})}},r)},Yt=(0,ee.$j)((function(e,t){return{formValues:(0,T.Z)(e,"form.publishedForm.".concat(t.token,".values"))}}))(Wt),Xt=n(86797),$t={"ant-btn":"Total_ant-btn__mo7r4","ant-select-selection-search-input":"Total_ant-select-selection-search-input__gL9ZM","ant-select":"Total_ant-select__PBeS0","ant-input":"Total_ant-input__RkW3N",total:"Total_total__15xne",docked:"Total_docked__QFg77","total-label":"Total_total-label__N2nOR","total-info":"Total_total-info__xXOIk","total-info-left":"Total_total-info-left__cUwYK","detail-info":"Total_detail-info__SSM1a","total-price":"Total_total-price__LPukP","total-info-right":"Total_total-info-right__Eidgm","footer-icon":"Total_footer-icon__1KiRx","total-mobile-info":"Total_total-mobile-info__eGKKE","total-mobile-info-left":"Total_total-mobile-info-left__Nzyjb","shopping-icon":"Total_shopping-icon__D-4zg","shopping-icon-img":"Total_shopping-icon-img__yMl4S","submit-btn-wrapper":"Total_submit-btn-wrapper__r4FzG","shopping-preferential":"Total_shopping-preferential__vALl3","shopping-total-price":"Total_shopping-total-price__aU57t","docked-right":"Total_docked-right__k+YSs","docked-btn":"Total_docked-btn__7muKN",arrow1:"Total_arrow1__hewfM",mobileCoverFadeOut:"Total_mobileCoverFadeOut__XFTqW",thumbUp:"Total_thumbUp__+RWli",bounce:"Total_bounce__MvW8Q",bling1:"Total_bling1__g2nmF",bling2:"Total_bling2__aQnNo",bling3:"Total_bling3__X8ewd",bling4:"Total_bling4__Nxbt5"},Jt=Ce.ZZ.isMobileScreen,zt=function(e){var t=e.goodTotal,i=e.reservationTotal,o=e.htmlEntity,r=e.docked,a=e.isDockedOpen,s=e.isoCode,l=e.setIsDockedOpen,c=e.currentPage,m=e.setCurrentPage,f=e.currentPageBreak,p=e.isFirstPage,v=e.isLastPage,h=(0,Q.$G)("field").t,_=t.totalPrice,g=t.totalCount,b=t.totalDiscountPrice,P=t.totalPreferential,y=(0,J.useContext)(fe.V5),C=y.form,T=y.theme,E=y.fields,A=y.isSubmitting,S=y.onSubmit,F=y.previewMode,Z=y.formStatus,x=i.totalPrice,R=i.totalCount,k=i.hasPayableItem,O=_+(null!==x&&void 0!==x?x:0),w=(null!==b&&void 0!==b?b:0)+(null!==x&&void 0!==x?x:0),j=P,N=g+R,I=(null===C||void 0===C?void 0:C.scene)===Fe.TPp.customer_acquisition,D=(null===C||void 0===C?void 0:C.scene)===Fe.TPp.reservation,M=I||Jt,L=g>0||k,B={onClick:r&&!M?function(){return null===l||void 0===l?void 0:l((function(e){return!e}))}:void 0};return(0,tt.jsxs)("div",(0,d.Z)((0,d.Z)({className:Xe()($t.total,(0,u.Z)({},$t.docked,r))},B),{},{children:[!(M&&r)&&(0,tt.jsxs)("div",{className:$t["total-info"],children:[(0,tt.jsxs)("div",{children:[(0,tt.jsx)("div",{className:$t["total-label"],children:h("common.total")}),(0,tt.jsxs)("div",{className:$t["total-info-left"],children:[R>0&&(0,tt.jsxs)("span",{className:$t["detail-info"],children:[(0,tt.jsx)("b",{children:R}),h("reservationfield.items")]}),g>0&&R>0&&(0,tt.jsx)("span",{children:"\u3001"}),g>0&&(0,tt.jsxs)("span",{className:$t["detail-info"],children:[(0,tt.jsx)("b",{children:g}),h("goods_field.items")]}),r&&(0,tt.jsxs)(tt.Fragment,{children:[h("goods_field.down_to_bottom"),(0,tt.jsx)(Je.Z,{className:$t["footer-icon"],type:a?"angle-double-down":"angle-double-up"})]})]})]}),L&&(0,tt.jsxs)("div",{className:$t["total-info-right"],children:[j>0&&(0,tt.jsxs)(tt.Fragment,{children:[!r&&(0,tt.jsxs)("div",{children:[h("goods_field.total_sum"),(0,tt.jsx)("span",{children:(0,Xt.T)(O,o)})]}),(0,tt.jsxs)("div",{children:[h("goods_field.mobile_discount_price"),(0,tt.jsxs)("span",{children:["-",(0,Xt.T)(j,o)]})]})]}),(0,tt.jsxs)("div",{children:[h("goods_field.mobile_total_price"),"(",s,")\uff1a",(0,tt.jsx)("b",{className:$t["total-price"],children:(0,Xt.T)(w,o)})]})]})]}),M&&r&&(0,tt.jsxs)("div",{className:$t["total-mobile-info"],children:[(0,tt.jsxs)("div",{className:$t["total-mobile-info-left"],children:[(0,tt.jsx)("div",{className:$t["shopping-icon"],onClick:function(){return null===l||void 0===l?void 0:l((function(e){return!e}))},children:(0,tt.jsx)(Ct.Z,{count:N,overflowCount:99,offset:[-5,5],children:(0,tt.jsx)("img",{className:$t["shopping-icon-img"],src:n(D?6459:11306)})})}),L&&(0,tt.jsxs)("div",{className:"bottom-shopping-cart__price",children:[j>0&&(0,tt.jsxs)("div",{className:$t["shopping-preferential"],children:[(0,tt.jsx)("span",{children:h("goods_field.mobile_discount_price")}),"-",(0,Xt.T)(j,o)]}),(0,tt.jsxs)("div",{children:[(0,tt.jsx)("span",{children:h("goods_field.mobile_total_price")}),(0,tt.jsx)("span",{className:$t["shopping-total-price"],children:(0,Xt.T)(w,o)})]})]})]}),(0,tt.jsxs)("div",{className:$t["docked-right"],children:[T&&!p&&!(null!==f&&void 0!==f&&f.disablePreviousPage)&&(0,tt.jsx)("div",{className:Xe()($t["docked-btn"],$t["prev-page-btn"]),children:(0,tt.jsx)(Kt,{currentPageBreak:f,currentPage:c,setCurrentPage:m,submitButtonStyle:null===C||void 0===C?void 0:C.theme.submitButton.style})}),T&&!v&&(0,tt.jsx)("div",{className:Xe()($t["docked-btn"],$t["next-page-btn"]),children:(0,tt.jsx)(qt,{submitButtonStyle:null===C||void 0===C?void 0:C.theme.submitButton.style,currentPageBreak:f,onSubmit:S})}),T&&C&&S&&E&&v&&(0,tt.jsx)("div",{className:Xe()($t["docked-btn"],$t["submit-btn"]),children:(0,tt.jsx)(Ft,{previewMode:F,theme:T.submitButton,form:C,isSubmitting:A,formStatus:Z,onSubmit:S,fields:E})})]})]})]}))},Qt={"ant-btn":"FieldsFootOuter_ant-btn__I9kiW","ant-select-selection-search-input":"FieldsFootOuter_ant-select-selection-search-input__2N1ft","ant-select":"FieldsFootOuter_ant-select__3jhJc","ant-input":"FieldsFootOuter_ant-input__9A-9a",docked:"FieldsFootOuter_docked__dJy0e","docked-mask":"FieldsFootOuter_docked-mask__LHxj2","docked-content":"FieldsFootOuter_docked-content__KQ661",foot:"FieldsFootOuter_foot__fqOX8",arrow1:"FieldsFootOuter_arrow1__WMHae",mobileCoverFadeOut:"FieldsFootOuter_mobileCoverFadeOut__XUHyq",thumbUp:"FieldsFootOuter_thumbUp__xQgYG",bounce:"FieldsFootOuter_bounce__LACnB",bling1:"FieldsFootOuter_bling1__gO1f5",bling2:"FieldsFootOuter_bling2__xlFSZ",bling3:"FieldsFootOuter_bling3__oH8Pp",bling4:"FieldsFootOuter_bling4__6EDgp"},en=(n(60377),n(31823)),tn=(n(59068),n(91281)),nn=n(6969),on=n(75307),rn={"ant-btn":"Goods_ant-btn__folai","ant-select-selection-search-input":"Goods_ant-select-selection-search-input__e4OWa","ant-select":"Goods_ant-select__g3B7X","ant-input":"Goods_ant-input__0t4Xn",goods:"Goods_goods__n5H-s",docked:"Goods_docked__921ji",header:"Goods_header__a1ZKy","header-right":"Goods_header-right__6U8dp",clear:"Goods_clear__eny1m","head-wrapper":"Goods_head-wrapper__o5xpz","head-quantity":"Goods_head-quantity__LDFe2","head-total":"Goods_head-total__ekFiK","col-quantity":"Goods_col-quantity__xgifC","col-price":"Goods_col-price__HwuTd","col-single-discount":"Goods_col-single-discount__v42vy","col-total":"Goods_col-total__MdtcZ",reservations:"Goods_reservations__fcfyy",good:"Goods_good__vGAzK","good-item":"Goods_good-item__ZxD+b","good-label":"Goods_good-label__8kfc-","good-items":"Goods_good-items__khkkP",sku:"Goods_sku__9GFbC",name:"Goods_name__-HNVw",arrow1:"Goods_arrow1__ihmnx",mobileCoverFadeOut:"Goods_mobileCoverFadeOut__eN-3F",thumbUp:"Goods_thumbUp__yIZfN",bounce:"Goods_bounce__ifbpc",bling1:"Goods_bling1__H5QMK",bling2:"Goods_bling2__BPZY-",bling3:"Goods_bling3__N3FKX",bling4:"Goods_bling4__46naU"},an=function(e){var t=e.goodTotal,n=e.goodWithValues,i=e.dispatch,o=e.formValues,r=e.formToken,a=e.docked,s=e.htmlEntity,l=t.goods,c=t.totalPrice,m=(0,J.useMemo)((function(){return(0,U.Z)(l,(function(e){return(0,U.Z)(e.purchases,(function(e){return!e.fixedNumber}))}))}),[l]);(0,J.useEffect)((function(){var e=document.createEvent("CustomEvent");e.initCustomEvent(Fe.$xI,!0,!0,{totalPrice:c,htmlEntity:s}),window.dispatchEvent(e)}),[c,s]);return(0,tt.jsxs)("div",{className:Xe()(rn.goods,(0,u.Z)({},rn.docked,a)),children:[(0,tt.jsxs)("div",{className:rn.header,children:[(0,tt.jsx)("div",{className:rn["header-left"],children:"\u5df2\u9009\u5546\u54c1"}),m&&(0,tt.jsxs)("div",{className:rn["header-right"],onClick:function(){var e={};(0,w.Z)(n,(function(e){return e.field.apiCode})).forEach((function(t){e[t]=o[t].map((function(e){return(0,d.Z)((0,d.Z)({},e),{},{number:0})}))})),Object.keys(e).forEach((function(t){i(ie.Z.change("publishedForm.".concat(r),t,e[t]))}))},children:[(0,tt.jsx)(nn.PublisheTtrash3Icon,{className:rn["clear-icon"],size:20}),(0,tt.jsx)("span",{className:rn.clear,children:"\u6e05\u7a7a"})]})]}),(0,tt.jsx)("div",{className:rn["head-wrapper"],children:(0,tt.jsxs)(en.Z,{className:rn.head,gutter:7,children:[(0,tt.jsx)(tn.Z,{span:8,className:rn["head-label"],children:"\u5546\u54c1"}),(0,tt.jsx)(tn.Z,{span:3,className:rn["head-price"],children:"\u5355\u4ef7"}),(0,tt.jsx)(tn.Z,{span:3,className:rn["head-single-discount"],children:"\u4f18\u60e0"}),(0,tt.jsx)(tn.Z,{span:6,className:rn["head-quantity"],children:"\u6570\u91cf"}),(0,tt.jsx)(tn.Z,{span:4,className:rn["head-total"],children:"\u5c0f\u8ba1"})]})}),(0,w.Z)(l,(function(e){var t=e.apiCode,n=e.label,i=e.purchases;return(0,tt.jsxs)("div",{className:rn.good,children:[(0,tt.jsx)("div",{className:rn["good-label"],children:n}),(0,tt.jsx)("div",{className:rn["good-items"],children:(0,w.Z)(i,(function(e){var n=e.name,i=e.itemSkuLabel,o=e.itemNumber,r=e.itemPrice,a=e.itemSpecification,l=e.preferential,d=e.discountPrice,u=e.value,c=e.inventory,m=e.fixedNumber,f=e.minPurchaseQuantity,p=e.maxPurchaseQuantity,v=e.dimensions,h=e.skus,_=!(0,y.Z)(v);return(0,tt.jsxs)(en.Z,{className:rn["good-item"],align:"middle",gutter:7,children:[(0,tt.jsxs)(tn.Z,{span:8,md:{span:8},xs:{span:24},className:rn["col-title"],children:[(0,tt.jsx)("div",{className:rn.name,children:n}),(0,tt.jsx)("div",{className:rn.sku,children:i})]}),(0,tt.jsx)(tn.Z,{span:3,md:{span:3},xs:{span:0},className:rn["col-price"],children:(0,Xt.T)(r,s)}),(0,tt.jsx)(tn.Z,{span:3,md:{span:3},xs:{span:6},className:rn["col-single-discount"],children:l>0?(0,Xt.T)(l,"-"+s):""}),(0,tt.jsx)(tn.Z,{span:6,md:{span:6},xs:{span:10},className:rn["col-quantity"],children:(0,tt.jsx)(on.gN,{specification:a,itemValue:u,inventory:c,fixedNumber:m,hasDimensions:_,number:o,skus:h,minPurchaseQuantity:f,maxPurchaseQuantity:p,name:t,component:$n})}),(0,tt.jsx)(tn.Z,{span:4,md:{span:4},xs:{span:8},className:rn["col-total"],children:(0,Xt.T)(d,s)})]},u+"-"+JSON.stringify(a))}))})]},t)}))]})},sn=n(79035),ln=n(8629),dn=["dimensions","originalPrice","price","skus"],un=function(e){var t=(0,J.useState)(0),n=(0,i.Z)(t,2),r=n[0],a=n[1];(0,J.useEffect)((function(){var e=function(e){var t=e.detail.discount;a(t)};return window.addEventListener(Fe.DIh,e),function(){return window.removeEventListener(Fe.DIh,e)}}));var s=0,l=0,u=0,c=0,m=(0,w.Z)(e,(function(e){var t,n=e.field.goodsItems,i=e.field.goodsPreferentialCase,r=e.field.goodsPreferentialType,a=(0,N.Z)(null!==(t=e.value)&&void 0!==t?t:[],(function(e){return e.number&&e.number>0})),m=(0,sn.Z)(a,(function(e){var t;return Number(null!==(t=e.number)&&void 0!==t?t:0)}));c+=m;var f=(0,w.Z)(a,(function(e){var t,a,c=null!==(t=function(e,t){var n=t.goodsItems;return(0,A.Z)(n,(function(t){return t.value===e}))}(e.value,{goodsItems:n}))&&void 0!==t?t:{},f=c.dimensions,p=c.originalPrice,v=c.price,h=c.skus,_=(0,o.Z)(c,dn),g=!(0,y.Z)(f),b=(0,A.Z)(h,(function(t){return t.specification.every((function(t){return e.specification[t.dimensionValue]===t.dimensionOptionValue}))})),P="";if(g){var C=[];(0,Z.Z)(null===b||void 0===b?void 0:b.specification,(function(e){var t,n,i,o=e.dimensionValue,r=e.dimensionOptionValue;C.push(null!==(t=null===(n=(0,A.Z)(f||[],(function(e){return e.value===o})))||void 0===n||null===(i=n.options.find((function(e){return e.value===r})))||void 0===i?void 0:i.label)&&void 0!==t?t:"")})),P=C.join((0,ln.k)(de.Z.language))}var T=b?b.price:null!==v&&void 0!==v?v:0,E=Number(null!==(a=e.number)&&void 0!==a?a:0),S=b?b.originalPrice:p,F=T*E,x=function(e,t,n,i,o){var r,a=i&&o&&o.discount,s=(null===o||void 0===o?void 0:o.discount)&&(null===o||void 0===o?void 0:o.name)===se.WQ,l=(null===o||void 0===o?void 0:o.discount)&&(null===o||void 0===o?void 0:o.name)===se.SW,d=i&&i.name===se.NM&&null!==i.endTime,u=i&&i.name===se.gY&&null!==i.minCount;if(a&&(d&&Date.parse(null===i||void 0===i?void 0:i.endTime)-Date.now()>0||u&&n>=(null!==(r=i.minCount)&&void 0!==r?r:0))){if(s)return o.discount*t*e;if(l)return o.discount*t}return 0}(T,E,m,r,i),R=F-x;return l+=R,s+=F,u+=x,(0,d.Z)((0,d.Z)({},_),{},{itemPrice:T,itemOriginalPrice:S,itemNumber:E,itemValue:e.value,itemSpecification:e.specification,itemSku:b,itemSkuLabel:P,price:F,skus:h,dimensions:f,discountPrice:R,preferential:x,goodsItemImages:null===c||void 0===c?void 0:c.goodsItemImages})}));return{apiCode:e.field.apiCode,label:e.field.label,count:m,purchases:f}})),f=(0,N.Z)(m,(function(e){return!(0,y.Z)(e.purchases)}));return{totalPrice:s,totalDiscountPrice:l-r,totalPreferential:u+r,totalCount:c,goods:f}},cn=n(70221),mn=n(18058),fn=n(52166),pn=n(56249),vn=n(67138),hn=n.n(vn),_n=n(82596),gn=n(68015),bn=n(21203),Pn=n(44613),yn=n(22275),Cn=J.createContext({}),Tn="ReservationRange_range__mYSkU",En="ReservationRange_range-option__LrCrL",An="ReservationRange_range-option-img__uBpx-",Sn="ReservationRange_range-list__SRivD",Fn="ReservationRange_range-item__0fm8d",Zn="ReservationRange_col-quantity__CmRUZ",xn="ReservationRange_col-price__JK7E1",Rn="ReservationRange_col-single-discount__VtuqO",kn="ReservationRange_col-total__CBcUu",On="ReservationRange_docked__vV3T9",wn="ReservationRange_payable__8R53P",jn="ReservationRange_col-title__Sk4OP",Nn=Ce.ZZ.isMobileScreen,In=function(e,t){var n=t.dailyTimeRangeQuotas;if(n&&e.scheduledAt){var i=(0,_n.WD)(n),o=(0,yn.Z)(e.scheduledAt).day(),r=gn.W[o];return null===i||void 0===i?void 0:i[r]}},Dn=function(e,t){var n=t.dailyTimeRangeQuotas,i=(0,yn.Z)(e.scheduledAt),o=(0,yn.Z)(e.endAt),r=i.days(),a=(0,bn.zS)(r),s={hour:i.format("HH"),minute:i.format("mm")},l={hour:o.format("HH"),minute:o.format("mm")};return(0,A.Z)(n,(function(e){return(0,q.Z)(e.startTime,s)&&(0,q.Z)(e.endTime,l)&&(!e.forWday||e.forWday===a.key)}))},Mn=function(e){var t,n=e.fieldApiCode,i=e.itemApiCode,o=e.scheduledAt,r=e.endAt,a=e.isByDay,s=e.children,l=(0,J.useContext)(fe.V5),d=l.token,u=l.routeType,c=(0,pn.a)(hn(),{variables:{formId:d,fieldApiCode:n,itemApiCode:i,routeType:u,startTime:o.clone().startOf("month").format(),endTime:o.clone().endOf("month").format()},fetchPolicy:"cache-first"}).data,m=o.clone().startOf("day").format(),f=(0,fn.XF)((0,T.Z)(c,"reservationItemMeta.quotaSummary"));if(a)t=null===f||void 0===f?void 0:f.get(m);else{var p,v,h="".concat(o.format(),"-").concat(null===r||void 0===r?void 0:r.format());t=null===(p=f.get(m))||void 0===p||null===(v=p.timeRangeQuotaObj)||void 0===v?void 0:v.get(h)}return s({currentSummary:t})},Ln=function(e){var t,n,i=e.value,o=e.reservationItem,r=e.onChange,a=e.docked,d=e.htmlEntity,c=e.hasPayableItem,m=e.itemApiCode,f=e.fieldApiCode,p=(0,J.useContext)(fe.V5).form,v=(0,J.useContext)(Cn).allowMultipleNumber,h=(0,Q.$G)("field").t,_=(0,J.useRef)(null),g=null===o||void 0===o?void 0:o.quotaSetting,b=null===o||void 0===o?void 0:o.payable,C=(0,N.Z)(i,(function(e){return!!e.scheduledAt})),T=null===g||void 0===g?void 0:g.dailyTimeRangeQuotas,E=function(e,t){if(t>0){var n=P()(C,(0,u.Z)({},e,{number:{$set:t}}));r(n)}if(t<=0){var i=function(){var t=P()(C,{$splice:[[e,1]]});r(t)};Nn?s().alert(h("reservationfield.remove_confirm_title"),h("reservationfield.remove_confirm_content"),[{text:h("common:cancel"),onPress:function(){var e;return null===(e=_.current)||void 0===e?void 0:e.reset()}},{text:h("common:confirm"),onPress:function(){return i()}}]):l.Z.confirm({title:h("reservationfield.remove_confirm_title"),content:(0,tt.jsx)(tt.Fragment,{children:(0,tt.jsx)("p",{children:h("reservationfield.remove_confirm_content")})}),okText:h("common:confirm"),cancelText:h("common:cancel"),onCancel:function(){var e;return null===(e=_.current)||void 0===e?void 0:e.reset()},onOk:function(){return i()}})}},A=(null===g||void 0===g?void 0:g.type)===cn.D.ByDayRepeatWeekly,S=(0,w.Z)(C,(function(e,t){var n,i,o,r,a,s=(0,yn.Z)(e.scheduledAt),l=e.endAt?(0,yn.Z)(e.endAt):void 0,u=b?A?null!==(n=null===(i=In(e,{dailyTimeRangeQuotas:T}))||void 0===i?void 0:i.price)&&void 0!==n?n:0:null!==(o=null===(r=Dn(e,{dailyTimeRangeQuotas:T}))||void 0===r?void 0:r.price)&&void 0!==o?o:0:0,p=null!==(a=e.number)&&void 0!==a?a:1,h=A?(0,tt.jsx)(tt.Fragment,{children:(null===s||void 0===s?void 0:s.format("LL"))+", "+(null===s||void 0===s?void 0:s.format("ddd"))}):(0,tt.jsxs)(tt.Fragment,{children:[(0,yn.Z)(s).format("LL")+", ",(0,tt.jsx)("span",{children:s.format("HH:mm")+"-"+(null===l||void 0===l?void 0:l.format("HH:mm"))})]});return(0,tt.jsx)(Mn,{fieldApiCode:f,itemApiCode:m,scheduledAt:s,endAt:l,isByDay:A,children:function(e){var n=e.currentSummary;return(0,tt.jsxs)(en.Z,{className:Fn,align:"middle",gutter:7,children:[(0,tt.jsx)(tn.Z,{span:10,md:{span:c?8:18},xs:{span:c?24:16},className:jn,children:h}),c&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(tn.Z,{span:3,md:{span:3},xs:{span:0},className:xn,children:(0,Xt.T)(u,d)}),(0,tt.jsx)(tn.Z,{span:3,md:{span:3},xs:{span:8},className:Rn})]}),(0,tt.jsx)(tn.Z,{span:4,md:{span:6},xs:{span:8},className:Zn,children:(0,tt.jsx)(Pn.wp,{value:p,onChange:function(e){return E(t,e)},ref:_,max:v?null===n||void 0===n?void 0:n.remainingQuota:1})}),c&&(0,tt.jsx)(tn.Z,{span:4,md:{span:4},xs:{span:8},className:kn,children:(0,Xt.T)(u*p,d)})]})}},s.format())})),F=null===o||void 0===o||null===(t=o.reservationItemImages)||void 0===t?void 0:t[0];return(0,tt.jsxs)("div",{className:Xe()(Tn,(0,u.Z)({},On,a),(0,u.Z)({},wn,c)),children:[(0,tt.jsxs)("div",{className:En,children:[F&&(0,tt.jsx)("div",{className:An,children:(0,tt.jsx)("img",{src:"qiniu"===(null===p||void 0===p||null===(n=p.storageConfig)||void 0===n?void 0:n.provider)?F.visitUrl+"@iclarge":F.visitUrl})}),null===o||void 0===o?void 0:o.name]}),!(0,y.Z)(C)&&(0,tt.jsx)("div",{className:Sn,children:S})]})},Bn={"ant-btn":"Reservation_ant-btn__ggLy7","ant-select-selection-search-input":"Reservation_ant-select-selection-search-input__XP45O","ant-select":"Reservation_ant-select__O5pXN","ant-input":"Reservation_ant-input__saqjv","head-wrapper":"Reservation_head-wrapper__2-GSj","head-quantity":"Reservation_head-quantity__3LQXz","head-total":"Reservation_head-total__X9Qkb","reservation-item":"Reservation_reservation-item__oUvtP",docked:"Reservation_docked__AknLU",payable:"Reservation_payable__dU+Ui",arrow1:"Reservation_arrow1__h8rmO",mobileCoverFadeOut:"Reservation_mobileCoverFadeOut__nRNYI",thumbUp:"Reservation_thumbUp__5Z4bu",bounce:"Reservation_bounce__Sr1AE",bling1:"Reservation_bling1__pb6Zd",bling2:"Reservation_bling2__vvTci",bling3:"Reservation_bling3__8PLsH",bling4:"Reservation_bling4__PychG"},Vn=function(e){var t=e.reservation,n=e.hasPayableItem,i=e.docked,o=e.dispatch,r=e.htmlEntity,a=e.formToken,s=(0,Q.$G)("field").t,l=t.field.label,d=t.field.reservationItems,c=t.value,m=t.field.allowMultipleNumber,f=(0,J.useMemo)((function(){return(0,O.Z)(d,"apiCode")}),[d]),p=(0,fn.qX)(c),v=function(e){var n=e?(0,fn.xo)(e):void 0;o(ie.Z.change("publishedForm.".concat(a),t.field.apiCode,n))};return(0,tt.jsxs)("div",{className:Xe()(Bn["reservation-item"],(0,u.Z)({},Bn.docked,i),(0,u.Z)({},Bn.payable,n)),children:[(0,tt.jsx)("div",{className:Bn["head-wrapper"],children:(0,tt.jsxs)(en.Z,{className:Bn.head,gutter:7,children:[(0,tt.jsx)(tn.Z,{span:n?8:18,className:Bn["head-label"],children:l}),n&&(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(tn.Z,{span:3,className:Bn["head-price"],children:s("goods_field.unit_price")}),(0,tt.jsx)(tn.Z,{span:3,className:Bn["head-single-discount"],children:s("goods_field.single_discount")})]}),(0,tt.jsx)(tn.Z,{span:6,className:Bn["head-quantity"],children:s("goods_field.quantity")}),n&&(0,tt.jsx)(tn.Z,{span:4,className:Bn["head-total"],children:s("goods_field.subtotal")})]})}),(0,tt.jsx)(Cn.Provider,{value:{allowMultipleNumber:m,reservationItems:d,value:p,reservationItemsObj:f,onChange:v},children:(0,w.Z)(p,(function(e,o){var a=f[o];return(0,tt.jsx)(Ln,{reservationItem:a,value:e.value,onChange:function(t){var n=(0,F.Z)(e);(0,mn.Z)(n,"value",t),v(P()(p,(0,u.Z)({},o,{$set:n})))},itemApiCode:o,fieldApiCode:t.field.apiCode,htmlEntity:r,docked:i,hasPayableItem:n},o)}))})]})},Hn="Reservations_reservations__One0a",Un="Reservations_header__zVAcO",Gn="Reservations_header-left__okNde",Wn="Reservations_header-right__OHbUs",Kn="Reservations_clear__9e2cg",qn="Reservations_docked__-k5eT",Yn=function(e){var t=e.reservationWithValues,n=e.dispatch,i=e.formToken,o=e.docked,r=e.reservationTotal,a=e.htmlEntity,s=r.hasPayableItem,l=(0,Q.$G)("field").t;return(0,tt.jsxs)("div",{className:Xe()(Hn,(0,u.Z)({},qn,o)),children:[(0,tt.jsxs)("div",{className:Un,children:[(0,tt.jsx)("div",{className:Gn,children:l("reservationfield.selected_item")}),(0,tt.jsxs)("div",{className:Wn,onClick:function(){(0,Z.Z)(t,(function(e){n(ie.Z.change("publishedForm.".concat(i),e.field.apiCode,[]))}))},children:[(0,tt.jsx)(nn.PublisheTtrash3Icon,{size:20}),(0,tt.jsx)("span",{className:Kn,children:l("common.clear")})]})]}),(0,w.Z)(t,(function(e){return(0,y.Z)(e.value)?null:(0,tt.jsx)(Vn,{reservation:e,dispatch:n,formToken:i,docked:o,hasPayableItem:s,htmlEntity:a},e.field.apiCode)}))]})},Xn=(0,ee.$j)((function(e,t){var n="publishedForm.".concat(t.formToken),i=(0,T.Z)(e,"form.".concat(n,".values")),o=t.reservationFields,r=t.goodsFields,a=(0,w.Z)(o,(function(e){return{field:e,value:null===i||void 0===i?void 0:i[e.apiCode]}})),s=(0,w.Z)(r,(function(e){return{field:e,value:null===i||void 0===i?void 0:i[e.apiCode]}}));return{formValues:i,reservationWithValues:a,goodWithValues:s}}),(function(e){return{dispatch:e}}))((function(e){var t=(0,J.useRef)(null),n=(0,J.useRef)(null),o=(0,J.useState)(!1),r=(0,i.Z)(o,2),a=r[0],s=r[1],l=(0,J.useContext)(gt.lB),c=l.window,m=l.document,f=function(){var e=document.querySelector(".published-form__footer");return t.current&&Pt(t.current,m,c)||e&&Pt(e,m,c)||!1},p=(0,J.useState)(f()),v=(0,i.Z)(p,2),h=v[0],_=v[1],g=(0,_t.Z)((function(){var e=f();e!==h&&a&&s(!1),_(e)}),200);(0,J.useEffect)((function(){var e=c||window;return e.addEventListener("scroll",g),function(){e.removeEventListener("scroll",g)}}),[g,c]),(0,J.useEffect)((function(){a?document.body.classList.add("with-mask"):document.body.classList.remove("with-mask")}),[a]);var b=e.goodWithValues,P=e.reservationWithValues,y=e.currentPage,C=e.totalPages,T=e.requiredFieldsOnly,E=un(b),S=function(e){var t=!1;return{totalPrice:(0,sn.Z)(e,(function(e){var n,i=e.field.reservationItems;return(0,sn.Z)(null!==(n=e.value)&&void 0!==n?n:[],(function(e){var n,o,r,a=e.api_code,s=e.number,l=e.scheduled_at,d=e.end_at,u=(0,A.Z)(i,(function(e){return a===e.apiCode})),c=null===u||void 0===u?void 0:u.quotaSetting.dailyTimeRangeQuotas,m=null===u||void 0===u?void 0:u.payable;return m&&!t&&(t=!0),r=(null===u||void 0===u?void 0:u.quotaSetting.type)===cn.D.ByDayRepeatWeekly?In({scheduledAt:l,endAt:d,number:s},{dailyTimeRangeQuotas:c}):Dn({scheduledAt:l,endAt:d,number:s},{dailyTimeRangeQuotas:c}),(m&&null!==(n=null===(o=r)||void 0===o?void 0:o.price)&&void 0!==n?n:0)*(null!==s&&void 0!==s?s:0)}))})),totalCount:(0,sn.Z)(e,(function(e){var t;return(0,sn.Z)(null!==(t=e.value)&&void 0!==t?t:[],(function(e){var t=e.number;return null!==t&&void 0!==t?t:1}))})),hasPayableItem:t}}(P),F=1===y,Z=y===C,x=E.totalCount<=0,R=S.totalCount<=0,k=x&&R,O=!h&&!k;return(0,J.useEffect)((function(){g()}),[y]),(0,J.useEffect)((function(){!O&&a&&s(!1)}),[O,a]),(0,tt.jsxs)(tt.Fragment,{children:[Z&&(!x||!R||!k)&&(0,tt.jsxs)("div",{ref:t,className:Xe()(Qt.foot,(0,u.Z)({},Qt["is-all-empty"],k)),children:[!x&&(0,tt.jsx)(an,(0,d.Z)((0,d.Z)({},e),{},{goodTotal:E})),!R&&(0,tt.jsx)(Yn,(0,d.Z)({reservationTotal:S},e)),!k&&(0,tt.jsx)(zt,(0,d.Z)((0,d.Z)({},e),{},{goodTotal:E,reservationTotal:S}))]}),O&&(0,tt.jsxs)("div",{className:Qt.docked,children:[(0,tt.jsx)(yt.Z,{duration:300,children:a&&(0,tt.jsxs)("div",{className:Qt["docked-content"],children:[!x&&(0,tt.jsx)(an,(0,d.Z)((0,d.Z)({},e),{},{goodTotal:E,docked:!0})),!R&&(0,tt.jsx)(Yn,(0,d.Z)((0,d.Z)({},e),{},{reservationTotal:S,docked:!0}))]})}),(0,tt.jsx)(zt,(0,d.Z)((0,d.Z)({},e),{},{requiredFieldsOnly:T,docked:!0,isDockedOpen:a,setIsDockedOpen:s,goodTotal:E,reservationTotal:S,isLastPage:Z,isFirstPage:F}))]}),(0,tt.jsx)(bt.Z,{transitionName:"fade",children:a&&O&&(0,tt.jsx)("div",{ref:n,onClick:function(e){e.target===n.current&&a&&s(!1)},className:Qt["docked-mask"]})})]})})),$n=function(e){var t=e.input,n=t.value,i=t.onChange,o=e.itemValue,r=e.inventory,a=e.fixedNumber,s=e.hasDimensions,l=e.number,d=e.skus,u=e.minPurchaseQuantity,c=e.maxPurchaseQuantity,m=e.specification;return(0,tt.jsx)(at.Z,{specification:m,itemValue:o,inventory:r,fixedNumber:a,hasDimensions:s,number:l,skus:d,minPurchaseQuantity:u,maxPurchaseQuantity:c,fieldValue:n,onChange:i})},Jn=function(e){var t=e.fields,n=e.fieldDefinitions,i=e.htmlEntity,o=e.relatedInfo,r=e.xFieldWeixinOpenid,a=e.formValueSubject$,s=e.scene,l=e.previewMobile,d=e.previewMode,u=e.typography,c=e.setting,m=e.token,f=e.routeType,p=e.isCaScene,v=e.storageConfig,h=e.theme;return(0,tt.jsx)(rt.Z.Row,{className:"fields",children:t.map((function(e){var t=(0,A.Z)(n,(function(t){return t.type===(e.customizedType||e.type)}));return(0,tt.jsx)(ht,{htmlEntity:i,field:e,valueRelated:o&&o[e.apiCode],xFieldWeixinOpenid:r,formValueSubject$:a,fieldDefinition:t,scene:s,previewMobile:l,previewMode:d,typography:u,setting:c,token:m,themeSubmitButton:h,routeType:f,isCaScene:p,storageConfig:v},e.apiCode)}))})};function zn(e,t){return(0,q.Z)(e,t)}Jn=J.memo(Jn,zn);var Qn=function(e){var t=e.fields,n=e.className,i=e.style,o=e.goodsFields,r=e.reservationFields,a=e.isoCode,s=e.htmlEntity,l=e.relatedInfo,d=e.xFieldWeixinOpenid,u=e.formValueSubject$,c=e.theme,m=e.isCaScene,f=e.totalPages,p=e.currentPage,v=e.setCurrentPage,h=e.currentPageBreak,_=e.requiredFieldsOnly,g=(0,J.useContext)(fe.V5),b=g.form,P=g.fieldDefinitions,y=g.previewMobile,C=g.previewMode,E=g.typography,A=g.token,S=g.routeType,F=(0,T.Z)(b,"scene")||"form",Z=null===b||void 0===b?void 0:b.setting;return(0,tt.jsxs)("div",{className:n,style:i,children:[(0,tt.jsx)(Jn,{fields:t,fieldDefinitions:P,htmlEntity:s,relatedInfo:l,xFieldWeixinOpenid:d,formValueSubject$:u,scene:F,previewMobile:y,previewMode:C,typography:E,setting:Z,storageConfig:null===b||void 0===b?void 0:b.storageConfig,token:A,routeType:S,isCaScene:m,theme:c}),A&&(0,tt.jsx)(Xn,{formToken:A,reservationFields:r,goodsFields:o,htmlEntity:s,isoCode:a,totalPages:f,currentPage:p,setCurrentPage:v,currentPageBreak:h,requiredFieldsOnly:_})]})},ei=J.memo(Qn),ti=n(27971),ni=n(50975),ii=n(92885),oi=function(e){var t,n=e.currentPage,o=e.currentPageBreak,r=e.dispatch,a=e.fields,s=e.form,l=e.formValueSubject$,u=e.goodsFields,c=e.reservationFields,m=e.handleSubmit,f=e.initialValues,p=e.isSubmitting,v=e.likeCount,h=e.onSubmit,_=e.previewMobile,g=e.previewMode,b=e.publishedForm,P=e.relatedInfo,C=e.requestFunction,E=e.routeType,S=e.search,F=e.setCurrentPage,Z=e.t,x=e.token,R=e.totalPages,k=e.xFieldWeixinOpenid,O=e.isCaScene,w=e.requiredFieldsOnly,j=(0,J.useState)(!1),N=(0,i.Z)(j,2),I=N[0],D=N[1],M=(0,J.useState)(!1),L=(0,i.Z)(M,2),B=L[0],V=L[1],H=(0,T.Z)(b,"form"),U=(0,T.Z)(b,"entryCountsPerChoice"),G=H.theme,W=H.currency,K=W.isoCode,q=W.htmlEntity,Y=H.scene,X=G.header,z=G.formContainer,Q=z.style,ee=z.indentOnLargePhone,te=z.divider,ne=te.enabled,ie=te.color,oe=z.shadow,ae=G.typography,se=(0,Ee.P)(Q),le=(0,Ee.P)((0,T.Z)(X,"textStyle")),de=(0,Ee.P)((0,T.Z)(X,"imageStyle")),ue=(0,d.Z)((0,d.Z)({},le),de),ce=(0,$.parse)(S),me=ce.banner,pe=void 0===me?"":me,ve=ce.background,he=ce.embedded;he&&se&&(se.backgroundColor=ve||se.backgroundColor);var ge=!(he&&"hide"===pe)&&ni.Z[X.type],be={currentPage:n,totalPages:R,setCurrentPage:F,currentPageBreak:o},Pe=1===n,ye=(0,J.useMemo)((function(){var e;return(0,re.S)(null===(e=b.form)||void 0===e?void 0:e.createdAt)}),[null===(t=b.form)||void 0===t?void 0:t.createdAt]),Ce=(0,T.Z)(b,"status.key","open"),Te=(0,T.Z)(b,"form.fields.nodes",[]),Ae=m((function(e){if(B||!(0,je.wJ)(e,Te))return h(e);D(!0)})),Se=m((function(e){return h(e)}));(0,J.useEffect)((function(){!0===B&&Ae()}),[B]);var Ze={typography:ae,form:H,routeType:E,token:x,previewMobile:_,previewMode:g,entryCountsPerChoice:U,theme:G,formStatus:Ce,onSubmit:Ae,isSubmitting:p,fields:a},xe=(0,T.Z)(b,"textReplacementList",[]),Re=function(e){if("bmw"!={NODE_ENV:"production",PUBLIC_URL:"https://gd-fe-assets.jinshujucdn.com",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUSHER_ENCRYPTED:"true",REACT_APP_HIDE_USER_INVITATION_BY_LINK:"false",REACT_APP_AUTOMATION_SCHEMA:"jenkins-downloads/automation-schema.json",REACT_APP_DINGTALK_SUITE_KEY:"suitemt2p3b4orpnfz2g7",REACT_APP_ENV:"prod",REACT_APP_SENTRY:"https://7f4fc835069c49b2aa02fd6404a8cfde@o154160.ingest.sentry.io/1360752",REACT_APP_API_DOMAIN:"/",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyCyPJuDMBEJlFBa22BLiVuwbTUJ5ZjHrCk",REACT_APP_PUSHER_INNERT_HOST:"vpce-06c95c07dbd9530f8-8y0axxzl.vpce-svc-0f1acf42d17490117.cn-northwest-1.vpce.amazonaws.com.cn",REACT_APP_MOBILE_WX_WORK_HOST:"https://qywechat.jinshuju.net",REACT_APP_PUSHER_HOST:"p.jinshuju.net",REACT_APP_TEMPLATE_HOST:"https://rubick.jinshuju.net",REACT_APP_MOBILE_WE_MEET_HOST:"https://wemeet.jinshuju.net",REACT_APP_PUSHER_APP_ID:"goldendata'",REACT_APP_AMAP_KEY:"825d0697d0a22be408d41eb8ef59d5ac",REACT_APP_SCHEMA:"jenkins-downloads/schema.json",REACT_APP_PUSHER_WS_PORT:"80",REACT_APP_AUTOMATION_GRAPHQL_ENDPOINT:"https://automen.jinshuju.net/graphql",REACT_APP_SERVICES_DING_TALK_HOST:"https://app82502.eapps.dingtalkcloud.com",REACT_APP_PUSHER_WSS_PORT:"443",REACT_APP_API_ENDPOINT:"/graphql",REACT_APP_HOWXM_AUTOMATION_ACTION_KEY:"scene_16",REACT_APP_GRAPHQL_ENDPOINT:"/graphql",REACT_APP_PUSHER_PORT:"4567",REACT_APP_MOBILE_DING_TALK_HOST:"https://dd.jinshuju.net",REACT_APP_SENTRY_PROJECT:"jinshuju-fe",REACT_APP_SENTRY_AUTH_TOKEN:"0f15b51b79aa45809a85407842c87cf0cc5ad277bf9f45ee9741479596e81b2e",REACT_APP_HOWXM_AUTOMATION_COUNT_KEY:"scene_17",REACT_APP_COOL_APP_CODE:"COOLAPP-1-101C5F496D182132B7AE000K",REACT_APP_HOWXM_DASHBOARD_RUNPLATFORM_KEY:"scene_14",REACT_APP_DINGTALK_APP_ID:"82502",REACT_APP_SUBMITTER_HIDE_INTRO:"false",REACT_APP_PUSHER_SECRET:"ishgahatthaywrerxcwq",REACT_APP_PUSHER_KEY:"goldendata",REACT_APP_TEMPLATE_MARKET_HOST:"https://templates.jinshuju.net",REACT_APP_HOWXM_AUTOMATION_TRIGGER_KEY:"scene_15",REACT_APP_DINGTALK_CORP_ID:"ding457d4e1aa3f16d1b4ac5d6980864d335",REACT_APP_PUBLIC_URL:"https://gd-fe-assets.jinshujucdn.com/",REACT_APP_FLEXMONSTER_LICENSE_KEY:"Z7WV-XHI404-2U2K2U-264015-5Z5J1N-036O2M-296467-24621D-551J1J-2V38",REACT_APP_MIXPANEL_TOKEN:"9552c9858ec0e05b5e9efa13f787750d",REACT_APP_PUSHER_INNER_HOST:"localhost",REACT_APP_CONTEXT_PATH:"",REACT_APP_AG_GRID_LICENSE:"CompanyName=XiAn Goldendata IT Co., Ltd.,LicensedGroup=jinshuju,LicenseType=MultipleApplications,LicensedConcurrentDeveloperCount=1,LicensedProductionInstancesCount=2,AssetReference=AG-022449,ExpiryDate=22_April_2023_[v2]_MTY4MjExODAwMDAwMA==998553bb1a8ae95d6437c9735c8dce1e"}.REACT_APP_CUST_CODE)return e;var t=(0,$.parse)(window.location.search).textReplacementId,n=(0,A.Z)(xe,(function(e){return e.fieldValues.field_1===t}));return n?e.replace(/\$var\$/g,n.fieldValues.field_2):e};return(0,J.useEffect)((function(){var e=(0,_e.Z)(s).getRelatedInfo();l.next(f);var t=H.setting.enableRecovery;if(r&&!(0,y.Z)(e)&&t){var n="publishedForm.".concat(H.token);r((0,ut.w8)({meta:{form:n},payload:e}))}}),[]),(0,J.useEffect)((function(){var e=(0,T.Z)((0,$.parse)(window.location.search),"code",""),t=(0,$.parse)(document.cookie.split("; ").join("&")).access_password;C&&C({variables:{formId:x,routeType:E,code:e,password:t}})}),[]),e.initialized?(0,tt.jsx)(ot.Z,{theme:ye,children:(0,tt.jsxs)(qe.Z,{className:Xe()("published-form__container ",{"small-width":ee,border:Q.borderWidth,"box-shadow":oe}),layout:"vertical",style:(0,d.Z)({},se),children:[(0,tt.jsx)(it,{form:H,theme:G}),ge&&Y!==Fe.TPp.customer_acquisition&&(0,tt.jsx)(ge,{bannerStyle:ue,header:X,className:"form-header__banner"}),Y!==Fe.TPp.customer_acquisition&&(0,tt.jsx)(ti.Z,{visible:Pe,title:Re(H.name),description:Re(H.description),theme:G,previewMode:g}),(0,tt.jsxs)(fe.V5.Provider,{value:Ze,children:[(0,tt.jsx)(ei,(0,d.Z)({fields:a,relatedInfo:P,xFieldWeixinOpenid:k,formValueSubject$:l,className:Xe()("published-form__body",{border:ne,cascene:O()}),style:(0,d.Z)({borderColor:ie},Y===Fe.TPp.customer_acquisition?{paddingTop:0}:{}),goodsFields:u,reservationFields:c,isoCode:K,htmlEntity:q,isCaScene:O,form:H,theme:G.submitButton,previewMode:g,requiredFieldsOnly:w},be)),(0,tt.jsx)(Yt,(0,d.Z)({token:x,fields:a,formStatus:Ce,previewMobile:_,previewMode:g,isSubmitting:p,form:H,theme:G.submitButton,onSubmit:Ae,onSubmitWithoutPrivacyValidate:Se,t:Z,likeCount:v,isCaScene:O,requiredFieldsOnly:w},be)),(0,tt.jsx)(ii.Z,{visible:I,onCancel:function(){D(!1),V(!1)},onConfirm:function(){D(!1),V(!0)}})]})]})}):null};oi=J.memo(oi);var ri,ai=oi=(0,$e.Z)({})(oi),si=n(42565),li=n(17345),di=n.n(li),ui=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;(0,m.Z)(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).retryTimes=Fe.FmE.RETRY_TIMES,e}return(0,f.Z)(n,[{key:"componentDidUpdate",value:function(e){if(this.props.weixinOauth&&!this.props.dataFetched){var t=this.props,n=t.weixinOauth,i=t.t,o=n.weixinOauthData,r=n.stopPolling;if((0,T.Z)(o,"accessToken")||this.retryTimes<=0){r();var a=o.accessToken,s=o.openid,l=o.userInfo;return(0,y.Z)(s)&&c.Z.error(i("warn_get_weixin_info_failed")),void this.props.updateWeixinOauthInfo({weixinAccessToken:a,xFieldWeixinOpenid:s,weixinInfo:l,dataFetched:!0,dataExist:!(0,y.Z)(s)})}(0,q.Z)(this.props.weixinOauth.networkStatus,e.weixinOauth.networkStatus)||(this.retryTimes=this.retryTimes-1)}}},{key:"render",value:function(){return null}}]),n}(J.Component),ci=(0,si.B)(di(),{name:"weixinOauth",withRef:!0,skip:function(e){var t=e.dataFetched;return!e.couldCollectWeixinData||t},options:function(e){var t=e.search,n=(0,$.parse)(t).code;return{variables:{code:void 0===n?"":n},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,pollInterval:Fe.FmE.INTERVAL_TIME}}})(ui),mi=n(87750),fi=n(31820),pi=n(60189),vi=["publishedFormData"],hi="cache_enableRecovery",_i=function(e){return!e.props.previewMode};!function(e){e.PseudoForm="pseudo_form"}(ri||(ri={}));var gi=(0,J.lazy)((function(){return n.e(7837).then(n.bind(n,62312))})),bi="gdBridgeSubmitPublishedForm",Pi=function(e){return"publishedForm.".concat(e)},yi=function(e){(0,v.Z)(n,e);var t=(0,h.Z)(n);function n(e){var i;(0,m.Z)(this,n),(i=t.call(this,e)).formWrapper=void 0,i.formValueSubject$=void 0,i.enableFieldCache=!1,i.validateValues=!1,i.submitFromGDBridge=!1,i.currentPageFields=[],i.publishedFormLoadedEvent=void 0,i.scrollToTop=null,i.examFieldValues=null,i.forceSubmit=!1,i.hasShuffledChoices=!1,i.matchedAbortIndex=-1,i.gdBridgeSubmitTriggerKey=null,i.publishedFormRef=J.createRef(),i.submitProxy=new Ke((0,p.Z)(i)),i.currentFieldsWithRules={},i.dispatchSubmit=function(e){var t,n,o,r=null===(t=e.detail)||void 0===t?void 0:t.key;if(i.gdBridgeSubmitTriggerKey!==r){i.gdBridgeSubmitTriggerKey=r;var a=new CustomEvent("gdBridgeSubmitPublishedForm_".concat(i.gdBridgeSubmitTriggerKey),{detail:{status:"submitting"}});window.dispatchEvent(a),null===(n=i.props)||void 0===n||null===(o=n.dispatch)||void 0===o||o.call(n,(0,te.Ps)(i.publishedFormId))}},i.handleCountDownOver=function(){var e;null===(e=i.submitProxy.validateUnScorableFieldsValues())||void 0===e||e.then((function(e){var t;if(null!==(t=e.data.validatePublishedFormFields.errors)&&void 0!==t&&t.length){var n;i.props.setRequiredFieldsOnly(!0);var o,r=(0,Se.Z)(i.token);if((null===(n=localStorage)||void 0===n||!n.getItem(r))&&i.enableRecovery)null===(o=localStorage)||void 0===o||o.setItem(r,"required")}}))},i.setApiCodesThatNeedFieldNumber=function(e){i.setState({apiCodesThatNeedFieldNumber:e.detail})},i.getFieldAndValues=function(e){if(!(0,y.Z)(e)){var t=i.props.publishedFormData,n=t.publishedForm,o=t.loading,r=t.error;if(!o&&!r){var a=n.form;if(a){var s=a.token,l=a.fields,d=we.h.getState().form.publishedForm[s],u=d.values[e],c=d.syncErrors&&d.syncErrors[e];return{value:u,field:l.nodes.find((function(t){return t.apiCode===e})),error:c}}}}},i.fillFormValue=function(e){var t=i.props.dispatch;t&&t(ie.Z.change(i.publishedFormId,e.detail.fieldName,e.detail.fieldValue))},i.omitFormValue=function(e){var t=i.props,n=t.formValue,o=t.dispatch;(0,y.Z)(n)||o&&o(ie.Z.initialize(i.publishedFormId,(0,C.Z)(n,e.detail.apiCodes)))},i.onChange=function(e){i.formValueSubject$.next(e);var t=i.props,n=t.publishedFormData.publishedForm,o=t.dynamicAttrsLoading,r=(0,T.Z)(n,"form");if(!1===o){var a,s,l=JSON.stringify(e);if(null===(a=localStorage)||void 0===a||a.setItem(i.publishedFormEntryCacheKey,l),i.enableRecovery)null===(s=localStorage)||void 0===s||s.removeItem(i.publishedFormSubmittedEntryCacheKey)}var d=(0,T.Z)(r,"fieldRulesGroupByTarget");(0,y.Z)(d)||i.setState({values:e})},i.getPageWhereFieldByApiCode=function(e){var t=(0,E.Z)(i.fieldsGroup,(function(t){return!!(0,A.Z)(t,(function(t){return t.apiCode===e}))}));return t>=0?t+1:1},i.reqErrorHandle=function(e){var t=i.props.t;navigator.onLine?c.Z.error(t("common:submit_form_error")):c.Z.error(t("common:submit_network_error"))},i.resErrorHandle=function(e){if(e&&(e.forEach((function(e){var t,n,o=e.message,r=e.path,a=e.details;if(!r)return!o&&a?void window.location.reload():(c.Z.error(o),void i.setState({hasSubmissionError:!0,captchaData:null}));var s=null===(t=r[1].match(/^field_\d+/i))||void 0===t?void 0:t[0];if(i.setState({hasSubmissionError:!0,captchaData:null}),!s)return i.setState({geetestCaptchaData:null}),void((0,S.Z)(i.gdBridgeSubmitTriggerKey)&&c.Z.error(o));var l=i.getPageWhereFieldByApiCode(s);throw l!==i.state.currentPage&&i.setCurrentPage(l),new ne.t((n={},(0,u.Z)(n,s,o),(0,u.Z)(n,"error",o),n))})),!(0,S.Z)(i.gdBridgeSubmitTriggerKey))){var t=new CustomEvent("gdBridgeSubmitPublishedForm_".concat(i.gdBridgeSubmitTriggerKey),{detail:{status:"failed",errors:e}});window.dispatchEvent(t),i.gdBridgeSubmitTriggerKey=null}},i.submit=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i.setState({isSubmitting:!0});var n=i.props,o=n.location,r=n.match.params.token,a=n.t,c=n.routeType,m=n.publishedFormData.publishedForm,f=n.requiredFieldsOnly,p=i.state,v=p.weixinAccessToken,h=p.xFieldWeixinOpenid,_=p.weixinInfo,g=(0,F.Z)(e);(0,Z.Z)(g,(function(e,t){var n=m.form.fields.nodes.find((function(e){return e.apiCode===t}));if((0,x.Z)(["TextField","MobileField","TelephoneField"],null===n||void 0===n?void 0:n.type)&&(g[t]=(0,R.Z)(e)),"TableField"===(null===n||void 0===n?void 0:n.type)&&(0,k.Z)(e)){var i=(0,O.Z)(n.dimensions,"apiCode"),o=(0,w.Z)(e,(function(e){return(0,j.Z)(e,(function(e,t){var n;return"FormulaField"===(null===(n=i[t])||void 0===n?void 0:n.type)&&0===e}))}));g[t]=(0,N.Z)(o,(function(e){return!(0,I.Z)(e,(function(e){return(0,y.Z)(e)&&!(0,D.Z)(e)}))}))}}));var b=(0,$.parse)(o.search),P=b,C=b.x_field_1,E=b.sign,A=b.cusd,S=b.referred_from,B=b.embedded,V=b.banner,H=b.background_image,U=b.form_margin,G=b.qz_gdt,W=b.qz_vid,K=b.internal,q=null;q=(0,$.parse)(document.cookie.split("; ").join("&"))["access_password_".concat(r)];var Y=i.state,X=Y.captchaData,J=Y.geetestCaptchaData,z=(0,T.Z)(m,"form");if(!r)return null;if(!i.props.createPublishedFormEntry||!i.props.validatePublishedFormFields)return!t&&i.validateValues&&i.setCurrentPage(i.state.currentPage+1),null;if(i.submitFromGDBridge)i.submitFromGDBridge=!1;else if(!t&&i.validateValues){var Q=i.currentPageFields.reduce((function(e,t){if(Object.hasOwnProperty.call(g,t.apiCode)){var n=(0,M.Z)([{addOnField:"intl_mobile_no_country_id",type:["MobileField","FormAssociation"]},{addOnField:"verification_token",type:["MobileField","FormAssociation"]},{addOnField:"other",type:["RadioButton","CheckBox","DropDown"]}].map((function(e){var n="".concat(t.apiCode,"_").concat(e.addOnField);return e.type.some((function(e){return e===t.type}))&&Object.hasOwnProperty.call(g,n)?[[n],g[n]]:[]})).filter((function(e){return!(0,y.Z)(e)})));return(0,d.Z)((0,d.Z)((0,d.Z)({},e),(0,u.Z)({},t.apiCode,g[t.apiCode])),n)}return e}),{}),ee=null===b||void 0===b?void 0:b.incognito_token;return i.props.validatePublishedFormFields({formId:r,entryAttributes:Q,xFieldWeixinOpenid:h,password:q,routeType:c,incognitoToken:Array.isArray(ee)?ee[0]:ee}).then((function(e){var t=e.data.validatePublishedFormFields.errors;i.resErrorHandle(t),i.setCurrentPage(i.state.currentPage+1)}))}var te=!!J,ne=!1;if(i.props.publishedFormData.publishedForm.form){var ie=i.props.publishedFormData.publishedForm.form.fields.nodes.filter((function(e){return["BasicGoodsField","GoodsField"].indexOf(e.__typename)>-1}));ne=0!==ie.length&&ie.every((function(e){var t=null!==e.goodsPreferentialCase&&0!==e.goodsPreferentialCase.discount,n=0===g[e.apiCode].length?0:g[e.apiCode].reduce((function(e,t){return{number:e.number+t.number}})).number;return null!==e.goodsPreferentialType&&e.goodsPreferentialType.name===se.NM&&t&&n>0&&Date.parse(e.goodsPreferentialType.endTime)+3e3-Date.now()>0}))}else ne=!1;var oe=i.forceSubmit||f&&i.publishReduxFormIsValid(),re={formId:r,entryAttributes:g,captchaData:X,weixinAccessToken:v,xFieldWeixinOpenid:h,weixinInfo:_,password:q,referredFrom:S&&S.toString(),xField1:C&&C.toString(),prefilledParams:(0,$.stringify)(P),sign:E&&E.toString(),cusd:A&&A.toString(),banner:V&&V.toString(),embedded:"true"===B,internal:!!K,backgroundImage:!!H,formMargin:!!U,qzGdt:G&&G.toString(),qzVid:W&&W.toString(),routeType:c,hasPreferential:ne,fillingDuration:20.330,forceSubmit:oe};if(te){var ae=J,le=ae.challenge,de=ae.seccode,ue=ae.validate;re.geetestData={type:"other",challenge:le,seccode:de,validate:ue}}else re.captchaData=X;return i.props.createPublishedFormEntry(re).then((function(e){var t,n,o,r,d,u,c=e.data,m=null===(t=c.createPublishedFormEntry)||void 0===t?void 0:t.cookies;(0,Ce.w1)()&&!(0,y.Z)(m)&&Object.keys(m).forEach((function(e){var t;null===(t=localStorage)||void 0===t||t.setItem(e,m[e].value)})),null!==(n=c.createPublishedFormEntry)&&void 0!==n&&null!==(o=n.errors)&&void 0!==o&&o.length&&i.setState({isSubmitting:!1});var f=c.createPublishedFormEntry.errors;i.resErrorHandle(f);var p=i.cachedFieldApiCodes(z),v=(0,_e.Z)(i.publishedFormId),h=(0,L.Z)(i.props.relatedInfo,p);(0,y.Z)(h)?v.removeRelatedInfo():v.setRelatedInfo(h),(0,be.Z)(),(0,Ne.I)();var _=c.createPublishedFormEntry.wxOnetimeMessageRedirectUrl&&Fe.FmE.OPEN_IN_WEIXIN&&!(0,Ce.p0)()?c.createPublishedFormEntry.wxOnetimeMessageRedirectUrl:c.createPublishedFormEntry.redirectUrl,g=null===(r=c.createPublishedFormEntry)||void 0===r?void 0:r.submitterExists,b=null===(d=c.createPublishedFormEntry)||void 0===d?void 0:d.identityFieldLabel;if(g){var P="\u8be5".concat(b||"\u624b\u673a\u53f7\u6216\u5fae\u4fe1","\u5df2\u5b58\u5728\uff0c\u65e0\u9700\u91cd\u590d\u6ce8\u518c");return Ce.Av?s().alert("\u6ce8\u518c\u63d0\u793a",(0,tt.jsx)("p",{children:P}),[{text:a("form:fields.option.cancel"),onPress:function(){return i.setState({isSubmitting:!1})}},{text:"\u524d\u5f80\u767b\u5f55",onPress:function(){return window.location.href=_}}]):l.Z.confirm({confirmType:"danger",title:"\u6ce8\u518c\u63d0\u793a",content:(0,tt.jsx)("p",{children:P}),okText:"\u524d\u5f80\u767b\u5f55",cancelText:a("form:fields.option.cancel"),onOk:function(){window.location.href=_},onCancel:function(){return i.setState({isSubmitting:!1})}})}var C=JSON.parse((null===(u=localStorage)||void 0===u?void 0:u.getItem(i.publishedFormEntryCacheKey))||"{}");if(!(0,y.Z)(C)&&(0,y.Z)(f)){var T,E=JSON.stringify(C);null===(T=localStorage)||void 0===T||T.setItem(i.publishedFormSubmittedEntryCacheKey,E)}return i.forceSubmit&&_&&(window.location.href=_),{redirectUrl:_,redirectToMiniprogramSuccess:c.createPublishedFormEntry.redirectToMiniprogramSuccess}})).catch((function(e){return i.setState({isSubmitting:!1}),i.reqErrorHandle(e),Promise.reject(e)}))},i.onSubmitSuccess=function(e){var t,n,o=i.props,r=o.match.params.token,a=o.location,s=o.publishedFormData.publishedForm,l=o.formValue,d=(0,$.parse)(a.search),u=d.embedded,c=d.inner_redirect,m=d.from_template_market;!i.validateValues&&i.state.isSubmitting&&(null===(n=localStorage)||void 0===n||n.removeItem(i.publishedFormEntryCacheKey),i.clearCurrentPageFromCache());if(null===(t=localStorage)||void 0===t||t.removeItem((0,Se.Z)(r)),(0,S.Z)(i.gdBridgeSubmitTriggerKey)){if("bmw"==={NODE_ENV:"production",PUBLIC_URL:"https://gd-fe-assets.jinshujucdn.com",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUSHER_ENCRYPTED:"true",REACT_APP_HIDE_USER_INVITATION_BY_LINK:"false",REACT_APP_AUTOMATION_SCHEMA:"jenkins-downloads/automation-schema.json",REACT_APP_DINGTALK_SUITE_KEY:"suitemt2p3b4orpnfz2g7",REACT_APP_ENV:"prod",REACT_APP_SENTRY:"https://7f4fc835069c49b2aa02fd6404a8cfde@o154160.ingest.sentry.io/1360752",REACT_APP_API_DOMAIN:"/",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyCyPJuDMBEJlFBa22BLiVuwbTUJ5ZjHrCk",REACT_APP_PUSHER_INNERT_HOST:"vpce-06c95c07dbd9530f8-8y0axxzl.vpce-svc-0f1acf42d17490117.cn-northwest-1.vpce.amazonaws.com.cn",REACT_APP_MOBILE_WX_WORK_HOST:"https://qywechat.jinshuju.net",REACT_APP_PUSHER_HOST:"p.jinshuju.net",REACT_APP_TEMPLATE_HOST:"https://rubick.jinshuju.net",REACT_APP_MOBILE_WE_MEET_HOST:"https://wemeet.jinshuju.net",REACT_APP_PUSHER_APP_ID:"goldendata'",REACT_APP_AMAP_KEY:"825d0697d0a22be408d41eb8ef59d5ac",REACT_APP_SCHEMA:"jenkins-downloads/schema.json",REACT_APP_PUSHER_WS_PORT:"80",REACT_APP_AUTOMATION_GRAPHQL_ENDPOINT:"https://automen.jinshuju.net/graphql",REACT_APP_SERVICES_DING_TALK_HOST:"https://app82502.eapps.dingtalkcloud.com",REACT_APP_PUSHER_WSS_PORT:"443",REACT_APP_API_ENDPOINT:"/graphql",REACT_APP_HOWXM_AUTOMATION_ACTION_KEY:"scene_16",REACT_APP_GRAPHQL_ENDPOINT:"/graphql",REACT_APP_PUSHER_PORT:"4567",REACT_APP_MOBILE_DING_TALK_HOST:"https://dd.jinshuju.net",REACT_APP_SENTRY_PROJECT:"jinshuju-fe",REACT_APP_SENTRY_AUTH_TOKEN:"0f15b51b79aa45809a85407842c87cf0cc5ad277bf9f45ee9741479596e81b2e",REACT_APP_HOWXM_AUTOMATION_COUNT_KEY:"scene_17",REACT_APP_COOL_APP_CODE:"COOLAPP-1-101C5F496D182132B7AE000K",REACT_APP_HOWXM_DASHBOARD_RUNPLATFORM_KEY:"scene_14",REACT_APP_DINGTALK_APP_ID:"82502",REACT_APP_SUBMITTER_HIDE_INTRO:"false",REACT_APP_PUSHER_SECRET:"ishgahatthaywrerxcwq",REACT_APP_PUSHER_KEY:"goldendata",REACT_APP_TEMPLATE_MARKET_HOST:"https://templates.jinshuju.net",REACT_APP_HOWXM_AUTOMATION_TRIGGER_KEY:"scene_15",REACT_APP_DINGTALK_CORP_ID:"ding457d4e1aa3f16d1b4ac5d6980864d335",REACT_APP_PUBLIC_URL:"https://gd-fe-assets.jinshujucdn.com/",REACT_APP_FLEXMONSTER_LICENSE_KEY:"Z7WV-XHI404-2U2K2U-264015-5Z5J1N-036O2M-296467-24621D-551J1J-2V38",REACT_APP_MIXPANEL_TOKEN:"9552c9858ec0e05b5e9efa13f787750d",REACT_APP_PUSHER_INNER_HOST:"localhost",REACT_APP_CONTEXT_PATH:"",REACT_APP_AG_GRID_LICENSE:"CompanyName=XiAn Goldendata IT Co., Ltd.,LicensedGroup=jinshuju,LicenseType=MultipleApplications,LicensedConcurrentDeveloperCount=1,LicensedProductionInstancesCount=2,AssetReference=AG-022449,ExpiryDate=22_April_2023_[v2]_MTY4MjExODAwMDAwMA==998553bb1a8ae95d6437c9735c8dce1e"}.REACT_APP_CUST_CODE){var f=(0,T.Z)(s,"form.fields.nodes")||[],p=(0,A.Z)(f,(function(e){return!!e&&"field_9"===e.apiCode})),v=(0,A.Z)(f,(function(e){return!!e&&"field_10"===e.apiCode})),h=(0,A.Z)(null===p||void 0===p?void 0:p.choices,(function(e){return!!e&&e.value===l.field_9})),_=(0,A.Z)(null===v||void 0===v?void 0:v.choices,(function(e){return!!e&&e.value===l.field_10}));ye("\u8868\u5355\u540d\u79f0\u6d4b\u8bd5","\u70b9\u51fb","\u63d0\u4ea4"),ye("\u8868\u5355\u540d\u79f0\u6d4b\u8bd5","\u70b9\u51fb","\u6ce8\u518c\u6210\u529f"),function(e,t,n,i,o){window.stm_clicki&&window.stm_clicki("send","event",{customActionId:1,customActionLabel1:e,customActionLabel2:t,customActionLabel3:n,customActionLabel4:i,customActionLabel5:o,customActionValue1:1})}(l.field_1,null===h||void 0===h?void 0:h.name,null===_||void 0===_?void 0:_.name,l.field_3,l.field_13)}if((0,Ce.F4)()&&null!==e&&void 0!==e&&e.redirectToMiniprogramSuccess&&(null===e||void 0===e?void 0:e.redirectUrl.indexOf("/success"))>-1)return void wx.miniProgram.redirectTo({url:"/pages/forms/success?source=gd&token=".concat(r)});if(null!==e&&void 0!==e&&e.redirectUrl){var g=(0,$.parse)(window.location.search).dealerId,b=g?e.redirectUrl+"?textReplacementId=".concat(g):e.redirectUrl;!u||c&&"false"!==c||m||window.location===window.parent.location?window.location.href=b:window.parent.location.href=b}}else{var P=new CustomEvent("gdBridgeSubmitPublishedForm_".concat(i.gdBridgeSubmitTriggerKey),{detail:{status:"success"}});window.dispatchEvent(P),i.gdBridgeSubmitTriggerKey=null}},i.handleSubmitFail=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"bmw"==={NODE_ENV:"production",PUBLIC_URL:"https://gd-fe-assets.jinshujucdn.com",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_PUSHER_ENCRYPTED:"true",REACT_APP_HIDE_USER_INVITATION_BY_LINK:"false",REACT_APP_AUTOMATION_SCHEMA:"jenkins-downloads/automation-schema.json",REACT_APP_DINGTALK_SUITE_KEY:"suitemt2p3b4orpnfz2g7",REACT_APP_ENV:"prod",REACT_APP_SENTRY:"https://7f4fc835069c49b2aa02fd6404a8cfde@o154160.ingest.sentry.io/1360752",REACT_APP_API_DOMAIN:"/",REACT_APP_GOOGLE_MAPS_API_KEY:"AIzaSyCyPJuDMBEJlFBa22BLiVuwbTUJ5ZjHrCk",REACT_APP_PUSHER_INNERT_HOST:"vpce-06c95c07dbd9530f8-8y0axxzl.vpce-svc-0f1acf42d17490117.cn-northwest-1.vpce.amazonaws.com.cn",REACT_APP_MOBILE_WX_WORK_HOST:"https://qywechat.jinshuju.net",REACT_APP_PUSHER_HOST:"p.jinshuju.net",REACT_APP_TEMPLATE_HOST:"https://rubick.jinshuju.net",REACT_APP_MOBILE_WE_MEET_HOST:"https://wemeet.jinshuju.net",REACT_APP_PUSHER_APP_ID:"goldendata'",REACT_APP_AMAP_KEY:"825d0697d0a22be408d41eb8ef59d5ac",REACT_APP_SCHEMA:"jenkins-downloads/schema.json",REACT_APP_PUSHER_WS_PORT:"80",REACT_APP_AUTOMATION_GRAPHQL_ENDPOINT:"https://automen.jinshuju.net/graphql",REACT_APP_SERVICES_DING_TALK_HOST:"https://app82502.eapps.dingtalkcloud.com",REACT_APP_PUSHER_WSS_PORT:"443",REACT_APP_API_ENDPOINT:"/graphql",REACT_APP_HOWXM_AUTOMATION_ACTION_KEY:"scene_16",REACT_APP_GRAPHQL_ENDPOINT:"/graphql",REACT_APP_PUSHER_PORT:"4567",REACT_APP_MOBILE_DING_TALK_HOST:"https://dd.jinshuju.net",REACT_APP_SENTRY_PROJECT:"jinshuju-fe",REACT_APP_SENTRY_AUTH_TOKEN:"0f15b51b79aa45809a85407842c87cf0cc5ad277bf9f45ee9741479596e81b2e",REACT_APP_HOWXM_AUTOMATION_COUNT_KEY:"scene_17",REACT_APP_COOL_APP_CODE:"COOLAPP-1-101C5F496D182132B7AE000K",REACT_APP_HOWXM_DASHBOARD_RUNPLATFORM_KEY:"scene_14",REACT_APP_DINGTALK_APP_ID:"82502",REACT_APP_SUBMITTER_HIDE_INTRO:"false",REACT_APP_PUSHER_SECRET:"ishgahatthaywrerxcwq",REACT_APP_PUSHER_KEY:"goldendata",REACT_APP_TEMPLATE_MARKET_HOST:"https://templates.jinshuju.net",REACT_APP_HOWXM_AUTOMATION_TRIGGER_KEY:"scene_15",REACT_APP_DINGTALK_CORP_ID:"ding457d4e1aa3f16d1b4ac5d6980864d335",REACT_APP_PUBLIC_URL:"https://gd-fe-assets.jinshujucdn.com/",REACT_APP_FLEXMONSTER_LICENSE_KEY:"Z7WV-XHI404-2U2K2U-264015-5Z5J1N-036O2M-296467-24621D-551J1J-2V38",REACT_APP_MIXPANEL_TOKEN:"9552c9858ec0e05b5e9efa13f787750d",REACT_APP_PUSHER_INNER_HOST:"localhost",REACT_APP_CONTEXT_PATH:"",REACT_APP_AG_GRID_LICENSE:"CompanyName=XiAn Goldendata IT Co., Ltd.,LicensedGroup=jinshuju,LicenseType=MultipleApplications,LicensedConcurrentDeveloperCount=1,LicensedProductionInstancesCount=2,AssetReference=AG-022449,ExpiryDate=22_April_2023_[v2]_MTY4MjExODAwMDAwMA==998553bb1a8ae95d6437c9735c8dce1e"}.REACT_APP_CUST_CODE&&ye("\u8868\u5355\u540d\u79f0\u6d4b\u8bd5","\u70b9\u51fb","\u63d0\u4ea4");try{e=(0,B.Z)(Object.keys(t))}catch(a){console.error(a)}if(e){var n,o=null===(n=i.formWrapper)||void 0===n?void 0:n.querySelector("[data-api-code='".concat(e,"']"));if(!o)return void i.setState({hasSubmissionError:!0,captchaData:null,geetestCaptchaData:null,isSubmitting:!1});o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}if(!(0,S.Z)(i.gdBridgeSubmitTriggerKey)){var r=new CustomEvent("gdBridgeSubmitPublishedForm_".concat(i.gdBridgeSubmitTriggerKey),{detail:{status:"failed"}});window.dispatchEvent(r),i.gdBridgeSubmitTriggerKey=null}},i.formValidate=function(e,t){var n=i.props.publishedFormData.publishedForm,o=(0,T.Z)(n,"form"),a=(0,T.Z)(o,"scene");if((0,ve.GE)(a)&&(i.examFieldValues=e,!(0,y.Z)(e)&&!(0,y.Z)(t.syncErrors))){var s=Object.keys(e).reduce((function(e,n){return t.syncErrors[n]&&(e=(0,d.Z)((0,d.Z)({},e),{},(0,u.Z)({},n,{$set:null}))),e}),{});i.examFieldValues=P()(i.examFieldValues,s)}if(!t.dirty)return{};var l={intl_mobile_no:le.Z,other_choice_presence:ue},c=((0,T.Z)(n,"form.fields.nodes")||[]).reduce((function(e,t){return(t.validations||[]).filter((function(e){return l[e]})).forEach((function(n){e[n]=[].concat((0,r.Z)(e[n]||[]),[t])})),e}),{}),m={};return Object.keys(l).map((function(t){return(c[t]||[]).forEach((function(n){var i=new l[t](n).validate(e);i&&(m[n.apiCode]=i)}))})),m},i.keepFieldCacheData=function(e){var t,n=e.mode,o=e.name,r=(e.token,e.form),a=JSON.parse((null===(t=localStorage)||void 0===t?void 0:t.getItem(o))||"{}");return Object.keys(a).reduce((function(e,t){var o=(0,A.Z)(r.fields.nodes,(function(e){return!!e&&(e.apiCode===t||"".concat(e.apiCode,"_other")===t||"".concat(e.apiCode,"_extended_text")===t)})),s=a[t];return o&&(n===hi||o.cacheData?e[t]=s:"MatrixField"!==o.type&&"TableField"!==o.type||(e[t]=i.keepDimensionCacheData(o,s))),e}),{})},i.keepDimensionCacheData=function(e,t){var n=(0,w.Z)((0,N.Z)(e.dimensions,(function(e){return e.cacheData})),(function(e){return e.apiCode})),i=(0,w.Z)(t,(function(e){return Object.keys(e)}))[0],o=[];if((0,Z.Z)(n,(function(e){o=(0,N.Z)(i,(function(t){return(0,V.Z)(t,e)})).concat(o)})),"MatrixField"===e.type){var r=e.statements.map((function(e){return e.apiCode})).reduce((function(e,n){return e[n]=t[n],e}),{});return(0,H.Z)(r,(function(e){return(0,L.Z)(e,o)}))}if("TableField"===e.type)return(0,w.Z)(t,(function(e){return(0,L.Z)(e,o)}))},i.cachedFieldApiCodes=function(e){return((0,T.Z)(e,"fields.nodes")||[]).reduce((function(e,t){var n;return t&&(n="MatrixField"===t.type||"TableField"===t.type?t.cacheData||(0,U.Z)(t.dimensions,(function(e){return!!e.cacheData})):t.cacheData),n?[].concat((0,r.Z)(e),[t.apiCode]):(0,r.Z)(e)}),[])},i.updateGeetestCaptchaInfo=function(e){var t=e.challenge,n=e.seccode,o=e.validate;i.setState({geetestCaptchaData:{challenge:t,seccode:n,validate:o,type:"other"},hasSubmissionError:!1})},i.updateCaptchaInfo=function(e){var t=e.name,n=e.value;i.setState({captchaData:{name:t,value:n},hasSubmissionError:!1,isSubmitting:!1})},i.updateWeixinOauthInfo=function(e){var t,n=e.weixinAccessToken,o=e.xFieldWeixinOpenid,r=e.weixinInfo,a=e.dataFetched,s=e.dataExist;i.setState({weixinAccessToken:n,weixinInfo:r,xFieldWeixinOpenid:o,dataFetched:a,dataExist:s}),null===(t=localStorage)||void 0===t||t.setItem("weixinInfo",JSON.stringify(r))},i.setCurrentPage=function(e,t){i.setState({currentPage:e,isSubmitting:!1},(function(){window.scrollTo(0,0),null===t||void 0===t||t()}))},i.getSliceParams=function(){var e=i.state.currentPage;return i.props.wouldForceSubmit?{currentPageFields:i.currentPageFields}:i.props.requiredFieldsOnly?{currentPageFields:i.props.unfilledFields}:{currentPageFields:i.fieldsGroup[e-1],currentPageBreak:i.pageBreaks.length>1?i.pageBreaks[e-1]:void 0}},i.getInitialValues=function(){var e,t,n=i.props,o=n.publishedFormData.publishedForm,r=n.match.params.token,a=(0,T.Z)(o,"entry.fieldValues"),s=i.allFields;(0,Z.Z)(s,(function(e){["FormAssociation","MultipleBlanksField"].indexOf(e.__typename)>-1&&!Object.hasOwnProperty.call(a,e.apiCode)&&(a[e.apiCode]=null)}));var l="",d={},u=(0,T.Z)(o,"form");function c(e){if(Fe.wBw.includes(e.__typename)){var t=e.goodsItems,n=e.apiCode,i=a[n],o=t.map((function(e){var t=e.dimensions,n=e.value,o=i?i.find((function(e){return e.value===n})):null;if(null!=o)return o;var r=t.length>0;return{value:n,number:0,specification:r?t.reduce((function(e,t){return e[t.value]=null,e}),{}):null}}));a[n]=o}}if(i.enableRecovery&&null!==(e=localStorage)&&void 0!==e&&e.getItem(i.publishedFormEntryCacheKey)&&(d=i.keepFieldCacheData({mode:hi,name:i.publishedFormEntryCacheKey,token:r,form:u})),null!==(t=localStorage)&&void 0!==t&&t.getItem(i.publishedFormSubmittedEntryCacheKey)&&(d=i.keepFieldCacheData({mode:"cache_cacheData",name:i.publishedFormSubmittedEntryCacheKey,token:r,form:u})),(0,y.Z)(d)||(l=JSON.stringify(d)),(0,y.Z)(l))return s.forEach(c),a;var m=l?JSON.parse(l):{};return s.forEach((function(e){c(e);var t=e.__typename,n=e.apiCode,i=(0,T.Z)(e,"choices");if(i&&t){var o=Fe.IWJ.includes(t),r=Fe.kz7.includes(t);if(o||r){var a=m[n];a&&(o&&i.every((function(e){return e.value!==a}))&&delete m[n],r&&((0,k.Z)(a)&&!a.some((function(e){return i.every((function(t){return t.value!==e}))}))||delete m[n]),i.forEach((function(e){0===e.quota&&(o&&e.value===a&&delete m[n],r&&a.includes(e.value)&&delete m[n])})))}}var s=(0,T.Z)(e,"reservationItems");if(s){var l=m[n];if(l){var d=(0,N.Z)(l,(function(e){return s.some((function(t){return(null===t||void 0===t?void 0:t.apiCode)===(null===e||void 0===e?void 0:e.api_code)&&!(null!==t&&void 0!==t&&t.hidden)}))}));m[n]=d}}})),(0,G.Z)({},a,m,(function(e,t){if(Array.isArray(e)&&Array.isArray(t)&&!(0,y.Z)(e)&&e.every((function(e){return Object.hasOwnProperty.call(e,"specification")})))return e.some((function(e){return null!==e.specification}))||t.some((function(e){return null!==e.specification}))||t.forEach((function(t){var n=e.findIndex((function(e){return(null===e||void 0===e?void 0:e.value)===(null===t||void 0===t?void 0:t.value)}));e[n]=t})),e}))},i.getFields=function(){var e=i.props.publishedFormData.publishedForm,t=i.state,n=t.apiCodesThatNeedFieldNumber,o=t.visibleFields,r=(0,T.Z)(e,"form.setting.showFieldNumber",!1),a=(0,T.Z)(e,"form.fields.nodes",[]);if(r){var s=1;a=a.map((function(e){if(Fe.Jie.includes(e.__typename)||null!=n&&!n.includes(e.apiCode))return e;var t="".concat(s,". ").concat(e.label);return null!==o&&void 0!==o&&o.find((function(t){return t.apiCode===e.apiCode}))&&(s+=1),(0,d.Z)((0,d.Z)({},e),{},{label:t})}))}return a},i.setSubmitButtonStatus=function(e){i.setState({disabledSubmitButton:e})},i.setDisabledAllButton=function(e){i.setState({disabledAllButton:e})},i.isFieldValid=function(e,t,n,o){return"or"===e?t.some((function(e){return i.compareValue(e,n,o)})):"and"!==e||t.every((function(e){return i.compareValue(e,n,o)}))},i.compareValue=function(e,t,n){var i=Array.isArray(e.value)?e.value:[e.value];return[].concat(t[e.trigger]).some((function(t){var o=n.find((function(t){return t.apiCode===e.trigger}));return"number"===typeof t&&Array.isArray(e.value)&&"between"===e.comparator?t>=e.value[0]&&t<=e.value[1]&&(0,T.Z)(o,"displayField",!0):(t="number"===typeof t?t.toString():t)&&"object"===typeof t&&!Array.isArray(t)?Object.keys(t).some((function(e){return i.includes(t[e])}))&&(0,T.Z)(o,"displayField",!0):i.includes(t)&&(0,T.Z)(o,"displayField",!0)}))},i.departureFieldRulesFilter=function(e,t,n){var o=e.reduce((function(e,t){var o=t.conditionGroup.conditionGroups,a=t.conditionGroup.operator,s=t.mode,l=(0,W.Z)(o,(function(e){return e.conditions})),d=i.isFieldValid(a,l,n,e);return[].concat((0,r.Z)(e),[{apiCode:t.target,mode:s,operator:a,conditions:l,displayField:"show"===s?d:!d}])}),[]);return t.filter((function(e){return!o.find((function(t){return t.apiCode===e.apiCode&&!t.displayField}))}))},i.handleOnReachLimits=function(){if(i.enableRecovery){var e,t=(0,Se.Z)(i.token);null===(e=localStorage)||void 0===e||e.setItem(t,"required")}i.submitProxy.validateUnScorableFieldsValues.bind((0,p.Z)(i))},i.formValueSubject$=new oe.X({}),i.publishedFormLoadedEvent=new CustomEvent("published_form_loaded",{bubbles:!0,cancelable:!0}),i.state={hasSubmissionError:!1,captchaData:null,geetestCaptchaData:null,weixinAccessToken:null,xFieldWeixinOpenid:null,weixinInfo:null,dataFetched:!1,dataExist:!1,disabledSubmitButton:!1,disabledAllButton:!1,values:{},apiCodesThatNeedFieldNumber:null,isSubmitting:!1,visibleFields:[],validateErrorFields:[],currentPage:1};var o=!1;if("performance"in window){if("navigation"in window.performance)o=0!==window.performance.navigation.type;else{var a=window.performance.getEntriesByType("navigation")[0];o="navigate"!==(0,T.Z)(a,"type")}if(o){var f=i.getCurrentPageFromCache(),v=(0,K.Z)(f)||f>i.totalPages||f<=0;!v&&i.enableRecovery||i.clearCurrentPageFromCache();var h=v?1:f;i.state=(0,d.Z)((0,d.Z)({},i.state),{},{currentPage:h})}else i.clearCurrentPageFromCache()}return i}return(0,f.Z)(n,[{key:"enableRecovery",get:function(){var e;return!(null===(e=this.props.publishedFormData.publishedForm.form)||void 0===e||!e.setting.enableRecovery)}},{key:"token",get:function(){return this.props.match.params.token}},{key:"publishedFormId",get:function(){return this.props.formName||Pi(this.token)}},{key:"publishedFormEntryCacheKey",get:function(){return"publishedForm-".concat(this.token)}},{key:"publishedFormSubmittedEntryCacheKey",get:function(){return"publishedForm-".concat(this.token,"-submit")}},{key:"currentPageCacheKey",get:function(){return"publishedForm-".concat(this.token,"-currentPage")}},{key:"allFields",get:function(){return this.getFields()}},{key:"fields",get:function(){var e,t,n=this.props,i=n.routeType,o=n.publishedFormData,r=this.state,a=r.values,s=r.visibleFields,l=(0,T.Z)(o,"publishedForm.form"),u=this.getInitialValues(),c=JSON.parse(null!==(e=null===l||void 0===l?void 0:l.defaultRulableHiddenValues)&&void 0!==e?e:"{}"),m=null===l||void 0===l||null===(t=l.fieldRulesGroupByTarget)||void 0===t?void 0:t.reduce((function(e,t,n){var i,o,r=[];null===t||void 0===t||null===(i=t.conditionGroup)||void 0===i||null===(o=i.conditionGroups)||void 0===o||o.forEach((function(e){e.conditions.forEach((function(e){r.push(e.trigger)}))}));var a=(0,E.Z)(e,(function(e){return r.indexOf(e.target)>-1}));return a>-1&&(e.splice(n,1),e.splice(a+1,0,t)),e}),null===l||void 0===l?void 0:l.fieldRulesGroupByTarget),f={};s.forEach((function(e){f[e.apiCode]=(0,T.Z)(a,e.apiCode)}));var p=(0,d.Z)((0,d.Z)((0,d.Z)({},c),i===ri.PseudoForm?u:{}),f),v=null!==l&&void 0!==l&&l.gdFieldRulesGroupByTargetAndOperatorEnabled?(0,pe.ET)(null===l||void 0===l?void 0:l.fieldRulesGroupByTargetAndOperator,this.allFields,p):this.departureFieldRulesFilter(m,this.allFields,p),h=v.reduce((function(e,t){return e[t.apiCode]=!0,e}),{});return(0,q.Z)(h,this.currentFieldsWithRules)||((0,fi.q)(pi.P3,h),this.currentFieldsWithRules=(0,d.Z)({},h)),(v||[]).filter((function(e,t){var n=(0,T.Z)(v,"".concat(t+1,".type"));return!("PageBreak"===e.type&&("PageBreak"===n||!n))}))}},{key:"pageBreaks",get:function(){var e=this.props.wouldForceSubmit,t=this.fields;return e?[]:t.filter((function(e){return"PageBreak"===e.type}))}},{key:"fieldsGroup",get:function(){return this.getFieldsCollectionAfterPaging(this.fields,this.pageBreaks)}},{key:"totalPages",get:function(){return Math.max(this.pageBreaks.length,1)}},{key:"publishReduxForm",value:function(){return(0,T.Z)(this,"publishedFormRef.current.ref.current",{})}},{key:"publishReduxFormIsValid",value:function(){var e=this.publishReduxForm();if(e)return e.isValid()}},{key:"handlePublishedFormLoaded",value:function(){this.publishedFormLoadedEvent&&(window.dispatchEvent(this.publishedFormLoadedEvent),this.publishedFormLoadedEvent=null)}},{key:"getCurrentPageFromCache",value:function(){var e;return Number(null===(e=localStorage)||void 0===e?void 0:e.getItem(this.currentPageCacheKey))}},{key:"setCurrentPageIntoCache",value:function(e){var t;null===(t=localStorage)||void 0===t||t.setItem(this.currentPageCacheKey,String(e))}},{key:"clearCurrentPageFromCache",value:function(){var e;null===(e=localStorage)||void 0===e||e.removeItem(this.currentPageCacheKey)}},{key:"UNSAFE_componentWillUpdate",value:function(e){e.wouldForceSubmit&&(0,ve.GE)(ve.ab)&&(0,be.Z)()}},{key:"componentDidUpdate",value:function(e,t){if(t.currentPage!==this.state.currentPage){this.enableRecovery&&this.setCurrentPageIntoCache(this.state.currentPage);var n=document.createEvent("CustomEvent");n.initCustomEvent("published_form_change_page",!0,!0,{previous:t.currentPage,current:this.state.currentPage}),window.dispatchEvent(n)}var i=this.props,o=i.publishedFormData,r=i.dispatch,a=i.formValue,s=(0,T.Z)(o,"publishedForm.entry.fieldValues");a&&!(0,q.Z)(s,(0,T.Z)(e.publishedFormData,"publishedForm.entry.fieldValues"))&&r&&r(ie.Z.initialize(this.publishedFormId,P()(a,{$set:this.getInitialValues()})));var l=(0,T.Z)(o,"publishedForm.form.scene");(0,Te.cW)({name:"filled_form_scene",value:l,domain:".".concat(window.location.host)})}},{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.frameWindow,i=t.focusoutDidMountCallback;window.addEventListener(Fe.$oX,this.fillFormValue),window.addEventListener(Fe.foL,this.omitFormValue),window.addEventListener(Fe.Fpc,this.setApiCodesThatNeedFieldNumber),window.addEventListener(bi,this.dispatchSubmit),window.addEventListener(Fe.XKr,this.handleCountDownOver),window.gdBridgeGetFieldAndValues=this.getFieldAndValues,window.gdBridgeSubmit=function(){var t,n;e.submitFromGDBridge=!0,null===(t=e.props)||void 0===t||null===(n=t.dispatch)||void 0===n||n.call(t,(0,te.Ps)(e.publishedFormId))},window.forceSubmit=function(){return e.validateValues=!1,e.forceSubmit=!0,e.submitProxy.forceSubmit()},n&&i&&(this.scrollToTop=i,n.addEventListener("focusout",this.scrollToTop)),this.props.requiredFieldsOnly&&this.submitProxy.forceSubmit().finally((function(){var e=new CustomEvent("gdBridgeSubmitPublishedForm");window.dispatchEvent(e)})),he(".published-form__container .published-form__body").then((function(){e.handlePublishedFormLoaded()}),(function(){throw Fe.ChS}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener(Fe.$oX,this.fillFormValue),window.removeEventListener(Fe.foL,this.omitFormValue),window.removeEventListener(Fe.Fpc,this.setApiCodesThatNeedFieldNumber),window.removeEventListener(bi,this.dispatchSubmit),window.removeEventListener(Fe.XKr,this.handleCountDownOver),this.formValueSubject$.unsubscribe();var e=this.props.frameWindow;e&&this.scrollToTop&&e.removeEventListener("focusout",this.scrollToTop)}},{key:"getFieldsCollectionAfterPaging",value:function(e,t){if((0,y.Z)(t))return[e];var n=[],i=(0,N.Z)(e,(function(e){return"WidgetContact"===e.type}));return(0,Z.Z)(t,(function(o,a){var s=(0,E.Z)(e,{apiCode:o.apiCode}),l=t[a+1]?(0,E.Z)(e,{apiCode:t[a+1].apiCode}):e.length,d=a<=0?e.slice(0,s):[];n.push([].concat((0,r.Z)(i),(0,r.Z)(d),(0,r.Z)(e.slice(s,l))))})),n}},{key:"render",value:function(){var e,t,n=this,i=this.props,o=i.publishedFormData,a=o.loading,s=o.publishedForm,l=o.error,u=i.routeType,c=i.previewMobile,m=i.location,f=i.t,p=i.formName,v=i.previewMode,h=i.requestFunction,_=i.dynamicAttrsLoading,g=i.formValue,b=i.wouldForceSubmit,P=i.setWouldForceSubmit,C=this.state,E=C.hasSubmissionError,A=C.currentPage,F=C.dataFetched,Z=C.dataExist,x=C.visibleFields;if(a||l)return null;var R,k,O=(0,T.Z)(s,"form");null!==O&&void 0!==O&&null!==(e=O.fields)&&void 0!==e&&e.nodes&&!this.hasShuffledChoices&&(O.fields.nodes=null===O||void 0===O||null===(R=O.fields)||void 0===R||null===(k=R.nodes)||void 0===k?void 0:k.map((function(e){if(null!==e&&void 0!==e&&e.randomChoices&&null!=(null===e||void 0===e?void 0:e.choices)){var t=(0,Y.Z)(null===e||void 0===e?void 0:e.choices,(function(e){return"OtherChoice"===e.__typename})),n=[].concat((0,r.Z)((0,X.Z)(null===e||void 0===e?void 0:e.choices)),(0,r.Z)(t));return(0,d.Z)((0,d.Z)({},e),{},{choices:n})}return e})),this.hasShuffledChoices=!0);var w=(0,T.Z)(s,"safeJumpEnabled"),j=(0,T.Z)(O,"likeCount"),N=(0,T.Z)(s,"entry");if((0,y.Z)(O)||(0,y.Z)(N))return null;var I=(0,T.Z)(O,"setting"),D=this.allFields;(0,_e.Z)(this.publishedFormEntryCacheKey).updateFormValueByAvailableFields(D,this.enableRecovery);var M=this.getInitialValues(),L=this.fields,B=L.map((function(e){return e.apiCode})),V=x.map((function(e){return e.apiCode}));(0,q.Z)(B,V)||this.setState({visibleFields:L});var H=(0,$.parse)(m.search).code,G=I&&I.entryWeixinOpenidRequired&&(Fe.FmE.OPEN_IN_WEIXIN||!(0,S.Z)(H))&&!v,W=I&&I.entryChangeableByWeixinSubmitter&&Fe.FmE.OPEN_IN_WEIXIN&&this.state.xFieldWeixinOpenid;this.enableFieldCache=!(!O.fields.nodes||null===(t=O.fields.nodes)||void 0===t||!t.some((function(e){return"MatrixField"===(null===e||void 0===e?void 0:e.type)||"TableField"===(null===e||void 0===e?void 0:e.type)?(null===e||void 0===e?void 0:e.cacheData)||(0,U.Z)(e.dimensions,(function(e){return!!e.cacheData})):null===e||void 0===e?void 0:e.cacheData})));var K=this.state.validateErrorFields,J=L.filter((function(e){return K.some((function(t){var n;return null===(n=t.path)||void 0===n?void 0:n.includes(e.apiCode)}))})),Q=this.totalPages,ee=this.getSliceParams(),te=ee.currentPageFields,ne=ee.currentPageBreak;this.currentPageFields=(0,je.JT)(D,(0,je.kL)(te,J));var ie={currentPage:A,totalPages:Q,setCurrentPage:this.setCurrentPage,currentPageBreak:ne};this.validateValues=!this.props.requiredFieldsOnly&&A!==Q;var oe=(0,d.Z)({},(0,Ie.L)(O.setting.extraConfigurableSettings)),re=(0,je.kL)((0,Ae.Z)(L,g),J),ae=(0,je.JT)(D,re);return(0,tt.jsx)(Ie.Z.Provider,{value:oe,children:(0,tt.jsx)(Ie.Z.Consumer,{children:function(e){var t,i,o,r,a,l;return(0,tt.jsxs)(tt.Fragment,{children:[(0,tt.jsx)(Me.Z,{disable:!v&&null!==(t=e.enabled)&&void 0!==t&&t&&null!==(i=e.switchingScreenDisabled)&&void 0!==i&&i&&!n.props.requiredFieldsOnly,limits:null!==(o=e.switchingScreenLimit)&&void 0!==o?o:0,threshold:null!==(r=e.switchingScreenLimitTime)&&void 0!==r?r:0,renderSwitchingScreenReminder:function(e){var t=e.switchedTimes,n=e.limits,i=e.onClose;return(0,tt.jsx)(Le.n,{switchedTimes:t,limits:n,onClose:i})},onReachLimits:n.handleOnReachLimits,renderReachingLimitsReminder:function(t){var i,o=t.onClose;return ae.length>0?(0,tt.jsx)(Be.Z,{onClose:o,onConfirm:function(){window.forceSubmit(),n.currentPageFields=ae,P(!0)}}):(0,tt.jsx)(Ve.Z,{onClose:o,limits:null!==(i=e.switchingScreenLimit)&&void 0!==i?i:0,onConfirm:function(){window.forceSubmit().finally((function(){setTimeout((function(){n.state.validateErrorFields.length&&n.props.setRequiredFieldsOnly(!0)}),0)}))}})}}),(0,tt.jsx)(De.Z,{disable:!v&&null!==(a=e.enabled)&&void 0!==a&&a&&null!==(l=e.copyingDisabled)&&void 0!==l&&l,children:(0,tt.jsxs)("div",{ref:function(e){return n.formWrapper=e},children:[(0,tt.jsx)(ce.Z,{onOk:n.props.handleClickAlertModalOK,visible:n.props.closedTimerAlertModalVisible}),(0,tt.jsx)(fe.T8.Provider,{value:{hasSubmissionError:E,dynamicAttrsLoading:_,disabledAllButton:n.state.disabledAllButton,setDisableAllButton:n.setDisabledAllButton,updateCaptchaInfo:n.updateCaptchaInfo,updateGeetestCaptchaInfo:n.updateGeetestCaptchaInfo,setSubmitButtonStatus:n.setSubmitButtonStatus,disabledSubmitButton:n.state.disabledSubmitButton||G&&!Z,safeJumpEnabled:w,publishedFormInstance:n.publishedFormRef.current},children:(0,tt.jsx)(ai,(0,d.Z)((0,d.Z)({ref:n.publishedFormRef,form:n.publishedFormId,validate:n.formValidate,onSubmit:b?window.forceSubmit:n.submit,publishedForm:s},ie),{},{fields:n.currentPageFields,initialValues:M,formValueSubject$:n.formValueSubject$,formValue:n.props.formValue,onSubmitSuccess:n.onSubmitSuccess,onSubmitFail:n.handleSubmitFail,shouldError:_i,onChange:n.onChange,search:m.search,routeType:u,token:n.token,relatedInfo:n.props.relatedInfo,xFieldWeixinOpenid:n.state.xFieldWeixinOpenid,formName:p,t:f,previewMobile:c,previewMode:v,requestFunction:h,goodsFields:L.filter((function(e){return Fe.wBw.includes(e.__typename)})),reservationFields:L.filter((function(e){return"ReservationField"===e.__typename})),likeCount:j,isSubmitting:n.state.isSubmitting,isCaScene:n.props.isCaScene,requiredFieldsOnly:n.props.requiredFieldsOnly}))}),(0,tt.jsx)(ci,{dataFetched:F,search:m.search,updateWeixinOauthInfo:n.updateWeixinOauthInfo,couldCollectWeixinData:G,t:f}),W&&(0,tt.jsx)(z.A,{query:xe(),variables:{formId:n.token,code:(0,T.Z)((0,$.parse)(m.search),"code",""),routeType:u},children:function(e){var t=e.data,n=(0,T.Z)(t,"publishedWeixinEntry");return n?(0,tt.jsx)(mi.Z,{t:f,publishedWeixinEntry:n}):null}})]})})]})}})})}}]),n}(J.PureComponent),Ci=J.memo((function(e){var t,n,r,a,s,l,u,c=e.publishedFormData,m=(0,o.Z)(e,vi),f=(0,$.parse)(window.location.search),p=(0,_.t)(ke(),{variables:{incognitoToken:null===f||void 0===f?void 0:f.incognito_token}}),v=(0,i.Z)(p,2),h=v[0],b=v[1],y=b.data,C=b.loading,E=null===y||void 0===y?void 0:y.publishedFormDynamicAttrs,A=c.publishedForm,S=E?P()(c,{publishedForm:{status:{$set:E.status},entry:{fieldValues:{$set:(0,d.Z)((0,d.Z)({},null===(t=A.entry)||void 0===t?void 0:t.fieldValues),null===(n=E.entry)||void 0===n?void 0:n.fieldValues)},weixinAccessToken:{$set:null===(r=E.entry)||void 0===r?void 0:r.weixinAccessToken},xFieldWeixinOpenid:{$set:null===(a=E.entry)||void 0===a?void 0:a.xFieldWeixinOpenid}},entryCountsPerChoice:{$set:E.entryCountsPerChoice},form:{likeCount:{$set:E.likeCount},fields:{nodes:{$set:null===(s=(0,F.Z)(A.form))||void 0===s||null===(l=s.fields.nodes)||void 0===l?void 0:l.map((function(e){var t=(null===e||void 0===e?void 0:e.apiCode)&&E.quotableFields[e.apiCode],n=(null===e||void 0===e?void 0:e.apiCode)&&E.inventoryFields[e.apiCode],i=(null===e||void 0===e?void 0:e.apiCode)&&E.marqueeDisplayData,o=(null===e||void 0===e?void 0:e.apiCode)&&E.marqueeEntriesCount;if(e){if(e.choices&&t){var r=Oe.Z.getDefinitionOf("RadioButton").dynamicUpdateQuota,a=Oe.Z.getDefinitionOf(e.type).dynamicUpdateQuota,s=void 0===a?r:a;s&&s({array:e.choices,subKey:"subChoices",quotas:t,node:e})}e.goodsItems&&n&&e.goodsItems.map((function(e){var t,i=n[e.value];i&&e&&(e.inventory=i.inventory,e.skus=null===(t=e.skus)||void 0===t?void 0:t.map((function(e){return P()(e,{inventory:{$set:i.skus[e.apiCode].inventory}})})));return e})),"WidgetMarquee"===e.type&&(e.marqueeDisplayData=i,e.marqueeEntriesCount=o)}return e}))}}}}}):c;if(S.publishedForm){var Z=S.publishedForm.form.theme.wallpaper;u=(0,Ee.P)((0,d.Z)((0,d.Z)({},Z),{},{backgroundImage:"url(".concat(Z.backgroundImageUrl,")"),backgroundRepeat:!Z.backgroundRepeat&&"no-repeat",backgroundSize:!Z.backgroundRepeat&&"cover",backgroundPosition:!Z.backgroundRepeat&&"top center"}))}else u={};var x=(0,T.Z)(S,"publishedForm.form.scene"),R=(0,T.Z)(S,"publishedForm.form.name"),k=(0,T.Z)(S,"publishedForm.form.createdAt"),O=(0,re.S)(k);return(0,tt.jsx)(ae.ZP,{toggleName:"should_use_mobile_view",children:function(e){var t=function(){return x===Fe.TPp.customer_acquisition&&e};return(0,tt.jsx)(g.Zp,{mobile:!0,children:function(e){return!e&&t()?(0,tt.jsx)(J.Suspense,{fallback:null,children:(0,tt.jsx)(gi,{mode:"mobile",style:(0,d.Z)({},u),loading:!1,mobileCover:!1,formTitle:R,excludeScale:!0,documentTheme:O,children:(0,tt.jsx)(yi,(0,d.Z)((0,d.Z)({dynamicAttrsLoading:C,publishedFormData:S,isCaScene:t},m),{},{requestFunction:h}))})}):(0,tt.jsx)(yi,(0,d.Z)((0,d.Z)({dynamicAttrsLoading:C,publishedFormData:S},m),{},{requestFunction:h,isCaScene:t}))}})}})}));Ci.displayName="MemoPublishedLayoutWithDynamicAttrs";var Ti=function(e){var t,n=e.publishedFormData.publishedForm,o=(0,T.Z)(e,"match.params.token")||"",r=JSON.parse((null===(t=localStorage)||void 0===t?void 0:t.getItem("publishedForm-".concat(o)))||"{}"),a=(0,ge.Z)(n,(0,d.Z)((0,d.Z)({},r),e.formValue)),s=a.modalOpen,l=a.requiredFieldsOnly,u=a.handleClickModalOk,c=a.unfilledFields,m=(0,J.useState)(!1),f=(0,i.Z)(m,2),p=f[0],v=f[1],h=(0,J.useState)(!1),_=(0,i.Z)(h,2),g=_[0],b=_[1],P=l||g;return(0,tt.jsxs)(tt.Fragment,{children:[(P||p)&&(0,tt.jsx)(me.Z,{}),(0,tt.jsx)(Ci,(0,d.Z)((0,d.Z)({},e),{},{wouldForceSubmit:p,setWouldForceSubmit:v,requiredFieldsOnly:P,setRequiredFieldsOnly:b,unfilledFields:c,closedTimerAlertModalVisible:s,handleClickAlertModalOK:u}))]})};var Ei=(0,ee.$j)((function(e,t){var n,i,o,r=t.formName||Pi((0,T.Z)(t,"match.params.token")||"");return{relatedInfo:(0,T.Z)(e,"form.".concat(r,".relatedInfo")),formValue:(0,T.Z)(e,"form.".concat(r,".values")),publishedFormData:t.publishedFormData||{publishedForm:null===(n=GD)||void 0===n||null===(i=n.publishedFormData)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.publishedForm}}}))((0,Q.Zh)(["form","captcha"])((function(e){var t;return null==(null===e||void 0===e||null===(t=e.publishedFormData)||void 0===t?void 0:t.publishedForm)?null:(0,tt.jsx)(Ti,(0,d.Z)({},e))})))},35882:function(e){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"likeForm"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"formId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"increase"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},defaultValue:{kind:"BooleanValue",value:!1},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"likeForm"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"formId"},value:{kind:"Variable",name:{kind:"Name",value:"formId"}}},{kind:"ObjectField",name:{kind:"Name",value:"increase"},value:{kind:"Variable",name:{kind:"Name",value:"increase"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"form"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"likeCount"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:207}};t.loc.source={body:"mutation likeForm($formId: ID!, $increase: Boolean = false) {\n  likeForm(input: { formId: $formId, increase: $increase }) {\n    form {\n      likeCount\n    }\n    errors {\n      code\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function o(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.likeForm=function(e,t){var n={kind:e.kind,definitions:[o(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,a=new Set,s=new Set;for(r.forEach((function(e){s.add(e)}));s.size>0;){var l=s;s=new Set,l.forEach((function(e){a.has(e)||(a.add(e),(i[e]||new Set).forEach((function(e){s.add(e)})))}))}return a.forEach((function(t){var i=o(e,t);i&&n.definitions.push(i)})),n}(t,"likeForm")},6459:function(e,t,n){"use strict";e.exports=n.p+"gd-frontend/media/reservation-cart.8cdc7a906cdee2141004.png"},11306:function(e,t,n){"use strict";e.exports=n.p+"gd-frontend/media/shopping-cart.57c28472896502477968.png"}}]);